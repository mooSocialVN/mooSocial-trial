!function(t){"function"==typeof define&&define.amd?define(["jquery","mooPhrase"],t):"undefined"!=typeof exports?module.exports=t(require("jquery")):root.mooSimpleModal=t()}(function(n,t){var d=null;n.fn.extend({buttons:null,options:null,defaults:{onAppend:null,offsetTop:null,overlayOpacity:.3,overlayColor:"#000000",width:400,draggable:!0,keyEsc:!0,overlayClick:!1,closeButton:!0,hideHeader:!1,hideFooter:!0,btn_ok:t.__("btn_ok"),btn_cancel:t.__("btn_cancel"),template:'<div class="simple-modal-header modal-header"><div class="title-modal">                 {_TITLE_}             </div></div>                 <div class="simple-modal-body modal-body">                 <div class="contents" id="simple-modal-body">{_CONTENTS_}</div>             </div>                 <div class="simple-modal-footer modal-footer"></div>'},SimpleModal:function(t){return(d=this).buttons=[],this.options=n.extend({},d.defaults,t),this},showModal:function(){var t=null;switch(this.options.model){case"modal-ajax":t=this._drawWindow(this.options),this._loadContents({url:d.options.param.url||"",onRequestComplete:this.options.param.onRequestComplete});break;case"confirm":this.addButton(this.options.btn_ok,"btn btn-modal_save",function(){d.options.callback(),d.hideModal()}),this.addButton(this.options.btn_cancel,"btn btn-modal_close"),t=this._drawWindow(this.options);break;case"modal":this.addButton(this.options.btn_ok,"btn btn-modal_save",function(){d.hideModal()}),t=this._drawWindow(this.options);break;case"content":t=this._drawWindow(this.options);break;default:this.addButton(this.options.btn_ok,"btn btn-modal_save"),t=this._drawWindow(this.options)}t&&this._display()},hideModal:function(){d._overlay("hide"),n(".modal-backdrop").remove(),n("#simpleModal").remove()},_drawWindow:function(t){var o=n("<div>").addClass("simple-modal modal-dialog").attr("id","simple-modal");return o.html(n("<div>").addClass("modal-content").html(this._template(d.options.template,{_TITLE_:t.title||"Untitled",_CONTENTS_:t.contents||""}))),o=n("<div>").addClass("modal fade in").attr("id","simpleModal").attr("aria-hidden",!1).attr("aria-labelledby","myModalLabel").attr("role","basic").css({display:"block"}).html(o),n("body").append(o),n("body").append('<div class="modal-backdrop fade in"></div>'),this._injectAllButtons(),this.options.onAppend&&this.options.onAppend.call(this),o},addButton:function(t,o,i){t=n("<a>").attr({title:t,class:o}).click(i?function(t){i.call(d,t)}:d.hideModal).text(t);return this.buttons.push(t),this},_injectAllButtons:function(){var i=n("#simple-modal").find(".simple-modal-footer");n.each(d.buttons,function(t,o){i.append(o)})},_addCloseButton:function(){var t=n("<a>").addClass("close").attr({href:"#"}).html('<i class="material-icons">clear</i>').click(function(t){return d.hideModal(),!1});return n("#simple-modal").append(t),t},_overlay:function(t){switch(t){case"show":var o=n("<div>").attr("id","simple-modal-overlay").css({"background-color":this.options.overlayColor,opacity:0});n("body").append(o),o.animate({opacity:this.options.overlayOpacity}),this.options.overlayClick&&o.click(function(t){d.hideModal()}),n(window).resize(d._display),n(document).keyup(d._escape);break;case"hide":n("#simple-modal-overlay").remove(),n("#simple-modal").remove(),n(window).unbind("resize",d._display),n(document).unbind("keyup",d._escape)}},_escape:function(t){27==t.keyCode&&d.hideModal()},_loadContents:function(a){n("#simple-modal-body").spin("small");var i,t=new RegExp(/([^\/\\]+)\.(jpg|png|gif)$/i),e=n("#simple-modal");a.url.match(t)?(e.addClass("hide-footer"),n("#simple-modal-overlay").unbind(),i=n("<img>").attr("src",a.url).load(function(){var t=e.find(".contents").empty().append(n(this).css("opacity",0)),o=e.width()-t.width(),t=e.height()-t.height(),o=n(this).width()+o,t=n(this).height()+t;e.animate({width:o,height:t,left:(n(window).width()-o)/2,top:(n(window).height()-t)/2},200,function(){i.animate({opacity:1})})})):n("#simple-modal .contents").load(a.url,function(t,o,i){var e=n("#simple-modal");"success"!==o?(e.find(".contents").html("loading failed"),a.onRequestFailure&&a.onRequestFailure()):(a.onRequestComplete&&a.onRequestComplete(),d._display())})},_display:function(){n("#simple-modal-overlay").css({width:n(window).width(),height:n(window).height()});var t=n("#simple-modal");d.options.offsetTop||(n(window).height(),t.height())},_template:function(t,o){for(var i in o)t=t.replace(new RegExp("{"+i+"}","g"),o[i]);return t}})});