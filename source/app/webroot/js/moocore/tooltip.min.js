(function(a,b){"function"===typeof define&&define.amd?define(["jquery","mooPhrase","qtip"],b):"object"===typeof exports?module.exports=b(require("jquery")):a.mooTooltip=b()})(this,function(a,b){var g=function(){if("undefined"==typeof mooViewer)return a.fn.SimpleModal({btn_ok:b.__("btn_ok"),btn_cancel:b.__("btn_cancel"),model:"modal",title:b.__("warning"),contents:b.__("please_login")}).showModal(),!1;if(mooCore["setting.require_email_validation"]&&!mooViewer.is_confirmed)return a.fn.SimpleModal({btn_ok:b.__("btn_ok"),
btn_cancel:b.__("btn_cancel"),model:"modal",title:b.__("confirm_email_warning"),contents:b.__("please_confirm_your_email")}).showModal(),!1;if(mooCore["setting.approve_users"]&&!mooViewer.is_approved)return a.fn.SimpleModal({btn_ok:b.__("btn_ok"),btn_cancel:b.__("btn_cancel"),model:"modal",title:b.__("warning"),contents:b.__("your_account_is_pending_approval")}).showModal(),!1;var e={status:!0,message:""};a("body").trigger("validateUser",[e]);return e.status?!0:(a.fn.SimpleModal({btn_ok:b.__("btn_ok"),
btn_cancel:b.__("btn_cancel"),model:"modal",title:b.__("warning"),contents:e.message}).showModal(),!1)};return{init:function(){0!=a("#page_share-ajax_share").length||1!=mooConfig.profile_popup||mooConfig.isMobile||(a(".qtip").qtip("hide"),mooConfig.rtl?a(".moocore_tooltip_link").qtip({content:{text:function(e,c){var f=a(this).data();a.post(mooConfig.url.base+"/users/ajax_load_tooltip",{item_id:f.item_id,item_type:f.item_type},function(h){c.set("content.text",h);a(".response_friend_request").length&&
(a(".response_friend_request").unbind("click"),a(".response_friend_request").on("click",function(){a(".response_request").show()}));a(".respondRequest").length&&(a(".respondRequest").unbind("click"),a(".respondRequest").on("click",function(){if(!g())return c.hide(),!1;var d=a(this).data();a.post(mooConfig.url.base+"/friends/ajax_respond",{id:d.id,status:d.status},function(k){location.reload()})}));a(".usertip_action_follow").unbind("click");a(".usertip_action_follow").click(function(){if(!g())return c.hide(),
!1;element=a(this);a.ajax({type:"POST",url:mooConfig.url.base+"/follows/ajax_update_follow",data:{user_id:a(this).data("uid")},success:function(d){element.data("follow")?(element.data("follow",0),element.find(".hidden-xs").html(b.__("text_follow")),element.find(".visible-xs").html("rss_feed")):(element.data("follow",1),element.find(".hidden-xs").html(b.__("text_unfollow")),element.find(".visible-xs").html("check"))}})})});return"Loading..."}},hide:{fixed:!0,delay:50,event:"mouseleave click"},position:{target:"event",
my:"top right",at:"left center",adjust:{y:0},viewport:a(window)},style:{classes:"qtip-social"}}):a(".moocore_tooltip_link").qtip({content:{text:function(e,c){var f=a(this).data();a.post(mooConfig.url.base+"/users/ajax_load_tooltip",{item_id:f.item_id,item_type:f.item_type},function(h){c.set("content.text",h);a(".response_friend_request").length&&(a(".response_friend_request").unbind("click"),a(".response_friend_request").on("click",function(){a(".response_request").show()}));a(".respondRequest").length&&
(a(".respondRequest").unbind("click"),a(".respondRequest").on("click",function(){if(!g())return c.hide(),!1;var d=a(this).data();a.post(mooConfig.url.base+"/friends/ajax_respond",{id:d.id,status:d.status},function(k){location.reload()})}));a(".usertip_action_follow").unbind("click");a(".usertip_action_follow").click(function(){if(!g())return c.hide(),!1;element=a(this);a.ajax({type:"POST",url:mooConfig.url.base+"/follows/ajax_update_follow",data:{user_id:a(this).data("uid")},success:function(d){a(".core_user_follow[data-uid="+
element.data("uid")+"]").each(function(){a(this).data("follow")?(a(this).data("follow",0),a(this).attr("data-follow",0),a(this).find(".btn-text").html(b.__("text_follow")),a(this).find(".btn-icon").html("rss_feed"),a(this).find(".btn-icon").removeClass("moo-icon-check"),a(this).find(".btn-icon").addClass("moo-icon-rss_feed")):(a(this).data("follow",1),a(this).attr("data-follow",1),a(this).find(".btn-text").html(b.__("text_unfollow")),a(this).find(".btn-icon").html("check"),a(this).find(".btn-icon").removeClass("moo-icon-rss_feed"),
a(this).find(".btn-icon").addClass("moo-icon-check"))})}})})});return b.__("loading")}},hide:{fixed:!0,delay:50,event:"mouseleave click"},position:{target:"event",my:"top left",at:"right center",adjust:{y:0},viewport:a(window)},style:{classes:"qtip-social"}}))}}});