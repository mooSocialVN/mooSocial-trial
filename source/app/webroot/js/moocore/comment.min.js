(function(a,f){"function"===typeof define&&define.amd?define("jquery mooPhrase mooMention mooToggleEmoji mooAttach mooBehavior mooLike mooTooltip mooAlert mooUser autogrow overlay".split(" "),f):"object"===typeof exports?module.exports=f(require("jquery")):a.mooComment=f()})(this,function(a,f,h,r,B,l,Q,p,R,t){var u=[],v=[],D=function(){a(".showCommentBtn").unbind("onfocus");a(".showCommentBtn").on("focus",function(){var b=a(this).data();C(b.id)})},E=function(){a(".removeItemComment").unbind("click");
a(".removeItemComment").click(function(){var b=a(this).data();S(b.id,b.photoComment)})},G=function(){a(".editItemComment").unbind("click");a(".editItemComment").click(function(){var b=a(this).data();F(b.id,b.photoComment)})},H=function(){a(".removeActivityComment").unbind("click");a(".removeActivityComment").click(function(){var b=a(this).data();T(b.activityCommentId)})},U=function(b){0==a("#activity_comment_edit_"+b).length&&a.post(mooConfig.url.base+"/activities/ajax_loadActivityCommentEdit/"+b,
function(c){a("#activity_feed_comment_text_"+b).hide();a(c).insertAfter(a("#activity_feed_comment_text_"+b));B.registerAttachCommentEdit("activity",b);u.push(b);a("textarea:not(.no-grow)").autogrow();h.init(a(c).find("textarea").attr("id"),"edit_activity");r.init(a(c).find("textarea").attr("id"),'<span class="post-area-icon material-icons moo-icon moo-icon-mood">mood</span>');a("body").trigger("afterShowFormEditCommentCallback",[{comment_id:b}])})},T=function(b){t.validateUser()&&a.fn.SimpleModal({btn_ok:f.__("btn_ok"),
btn_cancel:f.__("cancel"),callback:function(){a.post(mooConfig.url.base+"/activities/ajax_removeComment",{id:b},function(){a("#comment_"+b).fadeOut("normal",function(){a("#comment_"+b).remove();a("body").trigger("afterRemoveActivityCommentCallback",[])})})},title:f.__("please_confirm"),contents:f.__("please_confirm_remove_this_activity"),model:"confirm",hideFooter:!1,closeButton:!1}).showModal()},J=function(){a(".removePhotoComment").unbind("click");a(".removePhotoComment").on("click",function(){var b=
a(this).data();I(b.type,b.id)})},V=function(){a(".cancelEditActivityComment").unbind("click");a(".cancelEditActivityComment").click(function(){var b=a(this).data();w(b.id)})},W=function(){a(".confirmEditActivityComment").unbind("click");a(".confirmEditActivityComment").click(function(){var b=a(this).data();K(b.id)})},X=function(){a(".cancelEditItemComment").unbind("click");a(".cancelEditItemComment").click(function(){var b=a(this).data();x(b.id,b.photoComment)})},Y=function(){a(".confirmEditItemComment").unbind("click");
a(".confirmEditItemComment").click(function(){var b=a(this).data();L(b.id,b.photoComment)})},M=function(b){var c={emptyContent:!1,params:{}};a("body").trigger("beforePostCommentCallback",[c]);if(!0===c.emptyContent||""!=a.trim(a("#postComment").val())||""!=a.trim(a("#theaterPhotoComment").val())||""!=a.trim(a("#comment_image_"+b).val())||""!=a.trim(a("#theaterPhotoCommentForm #comment_image_"+b).val())||""!=a.trim(a("#userCommentLink"+b).val())||""!=a.trim(a("#userCommentVideo"+b).val()))if("1"===
mooConfig.comment_sort_style){a(".shareButton").addClass("disabled");a(".shareButton").append('<i class="icon-refresh icon-spin"></i>');var d="";a("#commentForm").length&&(d=a("#commentForm").serialize());a("#theaterPhotoCommentForm").length&&(d=a("#theaterPhotoCommentForm").serialize());null!=c.params&&(d=d+"&"+a.param(c.params));a.post(mooConfig.url.base+"/comments/ajax_share",d,function(e){a(".shareButton").removeClass("disabled");a(".shareButton i").remove();a(".commentForm").css("height","35px");
a("#postComment").length&&a("#postComment").val("");a("#theaterPhotoComment").length&&a("#theaterPhotoComment").val("");""!=e&&(a("#theaterComments").length?a("#theaterComments").append(e):a("#comments").append(e),a(".slide").slideDown(),a("#theaterComments").length||a("#comment_count").html(parseInt(a("#comment_count").html())+1),a("#comment_preview_image_"+b).html(""),a("#comment_image_"+b).val(""),a("#comment_button_attach_"+b).show(),a("#theaterPhotoCommentForm #comment_preview_image_"+b).html(""),
a("#theaterPhotoCommentForm #comment_image_"+b).val(""),a("#theaterPhotoCommentForm #comment_button_attach_"+b).show(),l.registerImageComment(),e=a("#postComment"),h.resetMention(e),e=a("#theaterPhotoComment"),h.resetMention(e),p.init());m(b);a("body").trigger("afterSubmitCommentCallbackSuccess",[c])})}else a(".shareButton").addClass("disabled"),a(".shareButton").prepend('<i class="icon-refresh icon-spin"></i>'),d="",a("#commentForm").length&&(d=a("#commentForm").serialize()),a("#theaterPhotoCommentForm").length&&
(d=a("#theaterPhotoCommentForm").serialize()),null!=c.params&&(d=d+"&"+a.param(c.params)),a.post(mooConfig.url.base+"/comments/ajax_share",d,function(e){a(".shareButton").removeClass("disabled");a(".shareButton i").remove();a(".commentForm").css("height","35px");a("#postComment").length&&a("#postComment").val("");a("#theaterPhotoComment").length&&a("#theaterPhotoComment").val("");""!=e&&(a("#theaterComments").length?a("#theaterComments").prepend(e):a("#comments").prepend(e),a(".slide").slideDown(),
a("#theaterComments").length||a("#comment_count").html(parseInt(a("#comment_count").html())+1),a("#comment_preview_image_"+b).html(""),a("#comment_image_"+b).val(""),a("#comment_button_attach_"+b).show(),a("#theaterPhotoCommentForm #comment_preview_image_"+b).html(""),a("#theaterPhotoCommentForm #comment_image_"+b).val(""),a("#theaterPhotoCommentForm #comment_button_attach_"+b).show(),l.registerImageComment(),e=a("#postComment"),h.resetMention(e),e=a("#theaterPhotoComment"),h.resetMention(e),p.init());
m(b);a("body").trigger("afterSubmitCommentCallbackSuccess",[c])});else a.fn.SimpleModal({btn_ok:f.__("btn_ok"),model:"modal",title:f.__("warning"),contents:f.__("comment_empty")}).showModal()},w=function(b){a("#message_activity_comment_edit_"+b).siblings(".textoverlay")&&a("#message_activity_comment_edit_"+b).destroyOverlayInstance(a("#message_activity_comment_edit_"+b));a("#activity_feed_comment_text_"+b).show();a("#activity_comment_edit_"+b).remove();b=a.inArray(b,u);u.splice(b,1);a("body").trigger("afterCancelFormEditCommentCallback",
[])},K=function(b){var c={emptyContent:!1,targetId:"",params:{}};a("body").trigger("beforeEditCommentCallback",[c]);if(!0===c.emptyContent&&parseInt(c.targetId)==b||""!=a.trim(a("#message_activity_comment_edit_"+b).val())||""!=a.trim(a("#activity_comment_attach_id_"+b).val())||""!=a.trim(a("#userCommentEditLink"+b).val())||""!=a.trim(a("#userCommentEditVideo"+b).val())){var d=0!=a("#message_activity_comment_edit_"+b+"_hidden").length?a("#message_activity_comment_edit_"+b+"_hidden").val():a("#message_activity_comment_edit_"+
b).val();d={comment_attach:a("#activity_comment_attach_id_"+b).val(),message:d,userCommentLink:a("#userCommentEditLink"+b).val(),userCommentVideo:a("#userCommentEditVideo"+b).val()};parseInt(c.targetId)==b&&null!=c.params&&a.extend(d,c.params);a.post(mooConfig.url.base+"/activities/ajax_editActivityComment/"+b,d,function(e){a("#message_activity_comment_edit_"+b).siblings(".textoverlay")&&a("#message_activity_comment_edit_"+b).destroyOverlayInstance(a("#message_activity_comment_edit_"+b));a("#activity_feed_comment_text_"+
b).html(a(e).html());a("#history_activity_comment_"+b).show();l.registerImageComment();w(b)})}},S=function(b,c){a.fn.SimpleModal({btn_ok:f.__("btn_ok"),btn_cancel:f.__("btn_cancel"),callback:function(){a.post(mooConfig.url.base+"/comments/ajax_remove",{id:b},function(){a("#itemcomment_"+b).fadeOut("normal",function(){a("#itemcomment_"+b).remove();"0"!=c?a("#comment_count").html(parseInt(a("#comment_count").html())-1):a("#photo_comment_"+b).remove();a("body").trigger("afterRemoveItemCommentCallback",
[{id:b,isTheaterMode:c}])})})},title:f.__("please_confirm"),contents:f.__("confirm_delete_comment"),model:"confirm",hideFooter:!1,closeButton:!1}).showModal()},F=function(b,c){if(0==a("#item_comment_edit_"+b).length){var d=0;"0"!=c&&(d=1);a.post(mooConfig.url.base+"/comments/ajax_loadCommentEdit/"+b,{isPhotoComment:d},function(e){var g="#item_feed_comment_text_";"0"!=c&&(g="#photo_feed_comment_text_");a(g+b).hide();a(e).insertAfter(a(g+b));B.registerAttachCommentEdit("item",b);v.push(b);a("textarea:not(.no-grow)").autogrow();
h.init(a(e).find("textarea").attr("id"),"edit_activity");0==a(".messageHidden").length&&h.addMention("","",a(e).find("textarea").attr("id"));r.init(a(e).find("textarea").attr("id"),'<span class="post-area-icon material-icons moo-icon moo-icon-mood">mood</span>');a("body").trigger("afterEditItemCommentCallback",[{comment_id:b,photoComment:c}])})}},x=function(b,c){a("#message_item_comment_edit_"+b).siblings(".textoverlay")&&a("#message_item_comment_edit_"+b).destroyOverlayInstance(a("#message_item_comment_edit_"+
b));var d="#item_feed_comment_text_";1==c&&(d="#photo_feed_comment_text_");a(d+b).show();a("#item_comment_edit_"+b).remove();d=a.inArray(b,v);v.splice(d,1);a("body").trigger("afterCancelEditItemCommentCallback",[{isPhotoComment:c,comment_id:b}])},L=function(b,c){var d={emptyContent:!1,targetId:"",params:{}};a("body").trigger("beforeEditCommentCallback",[d]);if(!0===d.emptyContent&&parseInt(d.targetId)==b||""!=a.trim(a("#message_item_comment_edit_"+b).val())||a.trim(""!=a("#item_comment_attach_id_"+
b).val())||""!=a.trim(a("#userCommentEditLink"+b).val())||""!=a.trim(a("#userCommentEditVideo"+b).val())){var e=0!=a("#message_item_comment_edit_"+b+"_hidden").length?a("#message_item_comment_edit_"+b+"_hidden").val():a("#message_item_comment_edit_"+b).val();e={comment_attach:a("#item_comment_attach_id_"+b).val(),message:e,userCommentLink:a("#userCommentEditLink"+b).val(),userCommentVideo:a("#userCommentEditVideo"+b).val()};parseInt(d.targetId)==b&&null!=d.params&&a.extend(e,d.params);a(".confirmEditItemComment").addClass("disabled");
a.post(mooConfig.url.base+"/comments/ajax_editComment/"+b,e,function(g){a("#message_item_comment_edit_"+b).siblings(".textoverlay")&&a("#message_item_comment_edit_"+b).destroyOverlayInstance(a("#message_item_comment_edit_"+b));a("#item_feed_comment_text_"+b).html(a(g).html());a("#photo_feed_comment_text_"+b).html(a(g).html());a("#history_item_comment_"+b).show();a("#history_activity_comment_"+b).show();a(".confirmEditItemComment").removeClass("disabled");l.registerImageComment();x(b,c);a("body").trigger("afterEditCommentCallback",
[d])})}},I=function(b,c){a("#"+b+"_comment_attach_id_"+c).val("");a("#"+b+"_comment_preview_attach_"+c).html("");a("#"+b+"_comment_attach_"+c).show();a("body").trigger("afterRemovePhotoCommentCallback",[])},C=function(b){a("#commentButton_"+b).show();0!=a("#commentForm_"+b).length&&0==a("#commentForm_"+b).siblings("input.messageHidden").length&&(h.init("commentForm_"+b),r.init("commentForm_"+b,'<span class="post-area-icon material-icons moo-icon moo-icon-mood">mood</span>'))},N=function(b,c){a(".item_reply_comment_viewmore").each(function(){data=
a(this).data();if(data.id==b)return a(this).parent().remove(),!0});div_id="item_comments_reply_"+b;a("#item_newComment_reply_"+b).is(":visible")&&!a("#"+div_id).hasClass("isLoadNew")?a("#item_commentReplyForm"+b).focus():(a("#item_newComment_reply_"+b).show(),a("#item_commentReplyForm"+b).focus(),a.post(mooConfig.url.base+"/comments/browse/comment/"+b+"/id_content:"+div_id+"/is_close_comment:"+c,function(d){if(""!=d){var e=a("#"+div_id).find(".comment_reply_lists");a("#"+div_id).hasClass("isLoadNew")&&
(e.empty(),a("#"+div_id).removeClass("isLoadNew"));"1"===mooConfig.reply_sort_style?e.prepend(d):e.append(d);p.init();l.registerImageComment()}}))},O=function(){a("body").off("click.comment","a.reply_reply_comment_button").on("click.comment","a.reply_reply_comment_button",function(){var c=a(this).data();type=c.type.replace("_"+c.id,"");var d="",e="item_newComment_reply_"+c.id;switch(type){case "item_comments_reply":d="item_commentReplyForm"+c.id;break;case "activitycomments_reply":d="activitycommentReplyForm"+
c.id;a("#activitynewComment_reply_"+c.id).is(":visible")||a("#activitynewComment_reply_"+c.id).show();e="activitynewComment_reply_"+c.id;break;case "comments_reply":d="commentReplyForm"+c.id,a("#newComment_reply_"+c.id).is(":visible")||a("#newComment_reply_"+c.id).show(),e="newComment_reply_"+c.id}if(a(this).hasClass("owner"))a("#"+e).attr("style","display:block !important;"),a("#"+d).focus();else if(""==a.trim(a("#"+d).val())){var g=a(this).next().html(),k=document.createElement("textarea");k.innerHTML=
g;g=k.value;0==a(".messageHidden").length&&h.addMention(c.user,g,d);a("#"+d).val(g);a("#"+d).parent().find(".messageHidden").val("@["+c.user+":"+g+"] ");a("#"+e).attr("style","display:block !important;");a("#"+d).focus()}});var b=0<a("#url_path").length?a("#url_path").val():window.location.pathname;a(document).ready(function(){var c=1;0<=b.indexOf("comment_id:")&&(0<a(".comment_list").length?a("html, body").animate({scrollTop:a(".comment_list").first().offset().top-120},1E3):a(document).ajaxStop(function(){c&&
0<a(".comment_list").length&&(a("html, body").animate({scrollTop:a(".comment_list").first().offset().top-120},1E3),c=0)}),a("#url_path").val(""))})},q=function(b,c,d,e){b=(result=b.match(/\b([\d\w\.\/\+\-\?:]*)((ht|f)tp(s|):\/\/|[\d\d\d|\d\d]\.[\d\d\d|\d\d]\.|www\.|\.tv|\.ac|\.com|\.edu|\.gov|\.int|\.mil|\.net|\.org|\.biz|\.info|\.name|\.pro|\.museum|\.co)([\d\w\.\/%\+\-=&amp;\?:\\&quot;',\|~;]*)\b/gi))?2>(result[0].match(/http/g)||[]).length?result[0].charAt(0).toLowerCase()+result[0].slice(1):"":
void 0;if(b&&("http://"==y(b,0,7)||"https://"==y(b,0,8)||"www."==y(b,0,4))){if(d){d=".userTagging-ReplyLink-";e=".userTagging-ReplyVideo-";var g="#userReplyLink",k="#userReplyVideo"}else e?(d=".userTagging-CommentEditLink-",e=".userTagging-CommentEditVideo-",g="#userCommentEditLink",k="#userCommentEditVideo"):(d=".userTagging-CommentLink-",e=".userTagging-CommentVideo-",g="#userCommentLink",k="#userCommentVideo");var z=n(b,"https://",0),A=n(b,"http://",0);if(0===z||0===A){z=n(b,"youtube.com",0);A=
n(b,"youtu.be",0);var Z=n(b,"vimeo.com",0);z||A||Z?a("#photoModal #photo-content").length?(a("#photoModal "+d+c).addClass("hidden"),a("#photoModal "+e+c).removeClass("hidden"),a("#photoModal "+g+c).val(""),a("#photoModal "+k+c).val(b)):(a(e+c).removeClass("hidden"),a(d+c).addClass("hidden"),a(g+c).val(""),a(k+c).val(b)):a("#photoModal #photo-content").length?(a("#photoModal "+d+c).removeClass("hidden"),a("#photoModal "+e+c).addClass("hidden"),a("#photoModal "+k+c).val(""),a("#photoModal "+g+c).val(b)):
(a(d+c).removeClass("hidden"),a(e+c).addClass("hidden"),a(k+c).val(""),a(g+c).val(b))}}},P=function(){a(".removeImage").unbind("click");a(".removeImage").on("click",function(){a(this).parent().remove()});a(".removeCommentContent").unbind("click");a(".removeCommentContent").on("click",function(){var b=a(this).data();m(b.id)})},m=function(b){a(".cmt_preview_link").remove();a("#userCommentLink"+b).val("");a("#userCommentVideo"+b).val("");a("#userCommentEditLink"+b).val("");a("#userCommentEditVideo"+
b).val("");a("#userReplyLink"+b).val("");a("#userReplyVideo"+b).val("");a("#photoModal #photo-content").length&&(a("#photoModal #userCommentLink"+b).val(""),a("#photoModal #userCommentVideo"+b).val(""),a("#photoModal #userCommentEditLink"+b).val(""),a("#photoModal #userCommentEditVideo"+b).val(""),a("#photoModal #userReplyLink"+b).val(""),a("#photoModal #userReplyVideo"+b).val(""));a("body").trigger("afterDestroyPreviewLinkCommentCallback",[])},n=function(b,c,d){b=(b+"").indexOf(c,d||0);return-1===
b?!1:b},y=function(b,c,d){0>c&&(c+=b.length);d=void 0==d?b.length:0>d?d+b.length:d+c;d<c&&(d=c);return b.substring(c,d)};return{ajax_postComment:M,initEditActivityComment:function(){a(".editActivityComment").unbind("click");a(".editActivityComment").click(function(){var b=a(this).data();U(b.activityCommentId)})},cancelEditActivityComment:w,confirmEditActivityComment:K,editItemComment:F,cancelEditItemComment:x,confirmEditItemComment:L,removePhotoComment:I,initShowCommentBtn:D,initShowCommentForm:function(){a(".showCommentForm").unbind("click");
a(".showCommentForm").click(function(){var b=a(this).data().id;a("#comments_"+b).show();a("#newComment_"+b).show();a("#commentForm_"+b).trigger("updateAutoGrow");a("#commentForm_"+b).focus();a("#commentForm_"+b).focus();a("body").trigger("afterShowFormCommentCallback",[])})},initOnCommentForm:function(){D();a(".shareButton").unbind("click");a(".shareButton").click(function(){var b=a(this).data();M(b.id)})},initOnCommentListing:function(){a("textarea:not(.no-grow)").autogrow();a("#comments li").hover(function(){a(this).contents(".cross-icon").show()},
function(){a(this).contents(".cross-icon").hide()});l.initMoreResults();Q.initLikeActivity();E();H();G()},initOnAjaxLoadCommentEdit:function(){a("textarea:not(.no-grow)").autogrow();X();Y();J();P()},initRemoveItemComment:E,initEditItemComment:G,showCommentButton:C,initRemoveActivityComment:H,initOnAjaxLoadActivityCommentEdit:function(){V();W();J();P()},initReplyCommentItem:function(){a("body").off("click.comment","a.item_reply_comment_button").on("click.comment","a.item_reply_comment_button",function(){var b=
a(this).data().id;N(b,0)});a("body").off("click.comment","a.item_reply_comment").on("click.comment","a.item_reply_comment",function(){if(t.validateUser()){var b=a(this).data();button=a(this);id=b.id;var c={emptyContent:!1,targetId:"",params:{}};a("body").trigger("beforePostReplyCallback",[c]);!0===c.emptyContent&&parseInt(c.targetId)==id||""!=a.trim(a("#item_commentReplyForm"+id).val())||""!=a.trim(a("#item_comment_reply_image_"+id).val())||""!=a.trim(a("#userReplyLink"+id).val())||""!=a.trim(a("#userReplyVideo"+
id).val())?(button.prepend('<i class="icon-refresh icon-spin"></i>'),button.addClass("disabled"),b="",b=0<a("#item_commentReplyForm"+id).siblings(".messageHidden").length?a("#item_commentReplyForm"+id).siblings(".messageHidden").val():a("#item_commentReplyForm"+id).val(),b={type:"comment",target_id:id,thumbnail:a("#item_comment_reply_image_"+id).val(),message:b,userCommentLink:a("#userReplyLink"+id).val(),userCommentVideo:a("#userReplyVideo"+id).val()},parseInt(c.targetId)==id&&null!=c.params&&a.extend(b,
c.params),a.post(mooConfig.url.base+"/comments/ajax_share",b,function(d){if(""!=d){var e=a("#item_newComment_reply_"+id).parent().find(".comment_reply_lists");a("#item_newComment_reply_"+id).parent().hasClass("isLoadNew")?e.append(d):"1"===mooConfig.reply_sort_style?e.append(d):e.prepend(d);a(".slide").slideDown();button.removeClass("disabled");a("#item_commentReplyForm"+id).val("");a(".commentBox").css("height","27px");a("#item_comment_reply_preview_image_"+id).html("");a("#item_comment_reply_image_"+
id).val("");a("#item_comment_reply_button_attach_"+id).show();l.registerImageComment();d=a("#item_commentReplyForm"+id);h.resetMention(d);p.init();m(id);a("body").trigger("afterSubmitReplySuccessCallback",[c])}})):a.fn.SimpleModal({btn_ok:f.__("btn_ok"),btn_cancel:f.__("cancel"),model:"modal",title:f.__("warning"),contents:f.__("share_comment_can_not_empty")}).showModal()}});a("body").off("click.comment","a.item_reply_comment_viewmore").on("click.comment","a.item_reply_comment_viewmore",function(){var b=
a(this).data();N(b.id,b.close)});O()},initReplyReply:O,initCloseComment:function(){a(".closeComment").unbind("click");a(".closeComment").click(function(){if(t.validateUser()){a(this).blur();var b=a(this).data();a.post(mooConfig.url.base+"/comments/ajax_close",{item_id:b.id,item_type:b.type},function(c){c=JSON.parse(c);1==c.result&&R.alert(c.message)});"1"==b.close?(a(this).html(f.__("close_comment")),a(this).data("close",0)):(a(this).html(f.__("open_comment")),a(this).data("close",1))}})},initParseComment:function(){a("body").on("paste",
"textarea.showCommentBtn",function(b){var c=a(this).data();if(!(a("#comment_image_"+c.id).length&&""!=a.trim(a("#comment_image_"+c.id).val())||a("#activity_comment_attach_id_"+c.id).length&&""!=a.trim(a("#activity_comment_attach_id_"+c.id).val())||a("#item_comment_preview_attach_"+c.id).length&&""!=a.trim(a("#item_comment_preview_attach_"+c.id).val())||a("#item_comment_attach_id_"+c.id).length&&""!=a.trim(a("#item_comment_attach_id_"+c.id).val()))&&b.originalEvent.clipboardData){var d=b.originalEvent.clipboardData.getData("text/uri-list");
""==d&&(d=b.originalEvent.clipboardData.getData("text/plain"));b=a(this).val()+d;d=!1;if(a(this).attr("id")=="message_item_comment_edit_"+c.id||a(this).attr("id")=="message_activity_comment_edit_"+c.id)d=!0;q(b,c.id,!1,d)}});a("body").on("keydown keyup keypress","textarea.showCommentBtn",function(b){var c=a(this).data();if(!(a("#comment_image_"+c.id).length&&""!=a.trim(a("#comment_image_"+c.id).val())||a("#activity_comment_attach_id_"+c.id).length&&""!=a.trim(a("#activity_comment_attach_id_"+c.id).val())||
a("#item_comment_preview_attach_"+c.id).length&&""!=a.trim(a("#item_comment_preview_attach_"+c.id).val())||a("#item_comment_attach_id_"+c.id).length&&""!=a.trim(a("#item_comment_attach_id_"+c.id).val())||b.ctrlKey))if(b=a(this).val(),""!=b){var d=!1;if(a(this).attr("id")=="message_item_comment_edit_"+c.id||a(this).attr("id")=="message_activity_comment_edit_"+c.id)d=!0;q(b,c.id,!1,d)}else m(c.id)});a("body").on("paste","textarea.showCommentReplyBtn",function(b){var c=a(this).data();if(!(a("#comment_reply_image_"+
c.id).length&&""!=a.trim(a("#comment_reply_image_"+c.id).val())||a("#activitycomment_reply_image_"+c.id).length&&""!=a.trim(a("#activitycomment_reply_image_"+c.id).val())||a("#item_comment_reply_image_"+c.id).length&&""!=a.trim(a("#item_comment_reply_image_"+c.id).val())||a("#item_comment_attach_id_"+c.id).length&&""!=a.trim(a("#item_comment_attach_id_"+c.id).val()))&&b.originalEvent.clipboardData){if(""!=a(this).val())var d=a(this).val();else d=b.originalEvent.clipboardData.getData("text/uri-list"),
""==d&&(d=b.originalEvent.clipboardData.getData("text/plain"));q(d,c.id,!0,!1)}});a("body").on("keydown keyup keypress","textarea.showCommentReplyBtn",function(b){var c=a(this).data();a("#comment_reply_image_"+c.id).length&&""!=a.trim(a("#comment_reply_image_"+c.id).val())||a("#activitycomment_reply_image_"+c.id).length&&""!=a.trim(a("#activitycomment_reply_image_"+c.id).val())||a("#item_comment_reply_image_"+c.id).length&&""!=a.trim(a("#item_comment_reply_image_"+c.id).val())||a("#item_comment_attach_id_"+
c.id).length&&""!=a.trim(a("#item_comment_attach_id_"+c.id).val())||b.ctrlKey||(b=a(this).val(),""!=b?q(b,c.id,!0,!1):m(c.id))})}}});