(function(a,c){"function"===typeof define&&define.amd?define("jquery mooPhrase mooUser mooToggleEmoji hideshare bootstrap".split(" "),c):"object"===typeof exports?module.exports=c(require("jquery")):a.mooShare=c()})(this,function(a,c,m,p){var k=0;window.closeModal=function(){a("#shareFeedModal").modal("hide")};window.statusModal=function(d,g){a.fn.SimpleModal({btn_ok:c.__("btn_ok"),btn_cancel:c.__("btn_cancel"),model:"modal",title:d,contents:g}).showModal()};window.initShareBtn=function(){a("body").off("click",
".shareFeedBtn").on("click",".shareFeedBtn",function(){if(!m.validateUser())return!1;var d=a(this).attr("share-url");a.post(mooConfig.url.base+"/share/index",function(g){try{g=JSON.parse(g),g.nonLogin&&m.validateUser()}catch(f){a("#shareFeedModal iframe").attr("src",d),a("#shareFeedModal").modal({show:!0})}})})};a(document).keyup(function(d){if(27==d.keyCode&&1==k)return n()});var n=function(){if(1==k){var d=c.__("are_you_sure_leave_this_page");if(confirm(d))return k=0,a(window).unbind("beforeunload"),
a("#themeModal").modal("hide"),!0}else k=0,a("#themeModal").modal("hide")};return{init:function(){a(window).on("beforeunload",function(){if(1==k)return n()});window.initShareBtn();a("#shareFeedModal").on("hidden.bs.modal",function(d){document.getElementById("iframeShare").height="0px";a(d.target).removeData("bs.modal")})},initOnAjaxShare:function(d){a(".sharethis").hideshare({linkedin:!1,link:d.social_link_share});a("#myTabDrop1").click(function(){a("#myTabDrop1-contents").toggleClass("show_hide_dropdown")});
var g=null;a('a[data-toggle="tab"]').on("shown.bs.tab",function(b){a("#shareWarning").html("").hide();a("#recaptcha_content").hide();g=b=a(b.target).attr("href");a("#share_type").val(b);switch(b){case "#friend":case "#msg":a("#friend").addClass("active in");a("#msg").remove("active in");break;case "#email":a("#recaptcha_content").show()}a("#myTabDrop1").html(a(this).html());a("body").height();a("#page_share-ajax_share .userTagged").css("position","fixed")});a('a[data-toggle="tab"]').click(function(){a("#myTabDrop1-contents").removeClass("show_hide_dropdown")});
a("#shareBtn").click(function(){a("#shareWarning").html("");switch(g){case "#friend":if(""==a("#friendSuggestion").val()){a("#shareWarning").html(c.__("please_select_friends_to_share")).show();return}break;case "#msg":if(""==a("#friendSuggestion").val()){a("#shareWarning").html(c.__("please_select_friends_to_share")).show();return}break;case "#group":if(""==a("#groupSuggestion").val()){a("#shareWarning").html(c.__("please_select_groups_to_share")).show();return}break;case "#email":if(""==a('textarea[name="data[email]"]').val()){a("#shareWarning").html(c.__("please_input_emails_to_share")).show();
return}}a("#shareBtn").addClass("disabled");a.post(d.do_share_url,a("#activity_share_form").serialize(),function(b){b=a.parseJSON(b);b.success?(window.parent.closeModal(),window.parent.statusModal(c.__("status"),b.msg)):(a("#shareWarning").html(b.msg).show(),a("#shareBtn").removeClass("disabled"))})});var f="",e="",l="";a("#myTabDrop1-contents li a").on("click",function(){var b=a(this).attr("href"),h=a(this).parents("#content-wrapper");"#msg"==b||"#email"==b||"#socialshare"==b?(f=h.find("textarea#message"),
e=h.find(".textoverlay-wrapper"),l=h.find(".userTagged .user-tagging-container"),0<e.length?(e.hide(),e.find("input.messageHidden").attr("name","messageTextHidden")):(f.hide(),f.attr("name","messageTextHidden")),h.find("#messageHidden").attr({name:"data[message]"}),h.find("#messageHidden").val(""),h.find("#messageHidden").show(),l.hide()):"object"===typeof f&&("object"===typeof e&&(h.find("#messageHidden").attr("name","messageTextHidden").hide(),0<e.length?(e.find("input.messageHidden").attr("name",
"data[message]"),e.find("input.messageHidden").val(""),e.find("div.textoverlay").html(""),e.show()):(f.attr("name","data[message]"),f.show()),f.val("")),"object"===typeof l&&l.show(),f=e=l="")})}}});