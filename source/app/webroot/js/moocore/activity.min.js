(function(a,h){"function"===typeof define&&define.amd?define("jquery mooPhrase mooBehavior mooMention mooToggleEmoji mooFileUploader mooUser mooButton mooGlobal mooResponsive mooAttach mooComment mooLike mooTooltip mooAlert autogrow spinner mooNiceSelect".split(" "),h):"object"===typeof exports?module.exports=h(require("jquery")):a.mooActivities=h()})(this,function(a,h,p,t,la,K,q,B,L,M,N,k,O,r,P){function Q(b,c){0==b.clipboardData&&"function"==typeof c&&c(void 0);var d=b.clipboardData.items;void 0==
d&&"function"==typeof c&&c(void 0);for(var f=0;f<d.length;f++)if(-1!=d[f].type.indexOf("image")){var e=d[f].getAsFile();"function"==typeof c&&c(e)}}function R(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=16*Math.random()|0;return("x"==b?c:c&3|8).toString(16)})}var T=function(){a(".removeTags").unbind("click");a(".removeTags").click(function(){var b=a(this).data();S(b.activityId,b.activityItemType)})},S=function(b,c){a.fn.SimpleModal({btn_ok:h.__("confirm"),btn_cancel:h.__("cancel"),
callback:function(){a.post(mooConfig.url.base+"/activities/ajax_remove_tags",{item_id:b,item_type:c},function(){window.location.reload()})},title:h.__("remove_tags"),contents:h.__("remove_tags_contents"),model:"confirm",hideFooter:!1,closeButton:!1}).showModal()},U=function(){a(".showAllComments").unbind("click");a(".showAllComments").on("click",function(){var b=a(this).data(),c="comments_"+b.id;a("#all_comments_"+b.id).hide();1==b.page&&a("#"+c+" div[id^=comments_reply_]").length&&a("html, body").animate({scrollTop:a("#"+
c).offset().top-150},900);a.post(mooConfig.url.base+"/activities/ajax_browse_comment/"+b.type+"/"+b.target+"/"+b.id+"/"+b.close+"/"+b.page,function(d){if(""!=d){var f=a("#"+c).find(".comment_parent_lists");1==b.page&&f.empty();"1"===mooConfig.comment_sort_style?f.prepend(d):f.append(d);r.init();p.registerImageComment();f.find(".comment-item").length<b.total&&(a("#all_comments_"+b.id+" .showAllComments").data("page",b.page+1),a("#all_comments_"+b.id).show())}a("body").trigger("afterShowAllCommentsCallback",
[{data:b}])})})},V=function(b){q.validateUser()&&a.fn.SimpleModal({btn_ok:h.__("ok"),btn_cancel:h.__("cancel"),callback:function(){a.post(mooConfig.url.base+"/activities/ajax_remove",{id:b},function(){a("#activity_"+b).fadeOut("normal",function(){a("#activity_"+b).remove();a("body").trigger("afterRemoveActivityCallback",[])})})},title:h.__("please_confirm"),contents:h.__("please_confirm_remove_this_activity"),model:"confirm",hideFooter:!1,closeButton:!1}).showModal()},X=function(){a(".editActivity").unbind("click");
a(".editActivity").click(function(){var b=a(this).data();W(b.activityId)})},Y=function(){a(".removeActivity").unbind("click");a(".removeActivity").click(function(){var b=a(this).data();V(b.activityId)})},x=[],W=function(b){0==a("#activity_edit_"+b).length&&a.post(mooConfig.url.base+"/activities/ajax_loadActivityEdit/"+b,function(c){a("#activity_feed_content_text_"+b+" .activity_feed_message").hide();a(c).insertAfter(a("#activity_feed_content_text_"+b+" .activity_feed_message"));x.push(b);y();t.init(a(c).find("textarea").attr("id"),
"edit_activity");a("body").trigger("afterLoadFormEditActivityCallback",[{activity_id:b}])})},C=function(b){a("#message_edit_"+b).siblings(".textoverlay")&&a("#message_edit_"+b).destroyOverlayInstance(a("#message_edit_"+b));a("#activity_feed_content_text_"+b+" .activity_feed_message").show();a("#activity_edit_"+b).remove();b=a.inArray(b,x);x.splice(b,1);a("body").trigger("afterCancelFormEditActivityCallback",[])},Z=function(b){var c={emptyContent:!1,targetId:"",params:{}};a("body").trigger("beforeEditActivityCallback",
[c]);if(!0===c.emptyContent&&parseInt(c.targetId)==b||""!=a.trim(a("#message_edit_"+b).val())){var d={message:0!=a("#message_edit_"+b+"_hidden").length?a("#message_edit_"+b+"_hidden").val():a("#message_edit_"+b).val()};parseInt(c.targetId)==b&&null!=c.params&&a.extend(d,c.params);a.post(mooConfig.url.base+"/activities/ajax_editActivity/"+b,d,function(f){a("#message_edit_"+b).siblings(".textoverlay")&&a("#message_edit_"+b).destroyOverlayInstance(a("#message_edit_"+b));a("#activity_feed_content_text_"+
b+" .activity_feed_message").html(a(f).html());a("#history_activity_"+b).show();C(b);a("body").trigger("afterEditActivityCallback",[c])})}},aa=function(b){a.fn.SimpleModal({btn_ok:h.__("ok"),btn_cancel:h.__("cancel"),callback:function(){a.post(mooConfig.url.base+"/comments/ajax_remove",{id:b},function(){a("#photo_comment_"+b).fadeOut("normal",function(){a("#photo_comment_"+b).remove()})})},title:h.__("please_confirm"),contents:h.__("please_confirm_remove_this_activity"),model:"confirm",hideFooter:!1,
closeButton:!1}).showModal()},ba=function(b){if(q.validateUser()){var c={emptyContent:!1,targetId:"",params:{}};a("body").trigger("beforePostCommentCallback",[c]);if(!0===c.emptyContent&&parseInt(c.targetId)==b||""!=a.trim(a("#commentForm_"+b).val())||""!=a.trim(a("#comment_image_"+b).val())||""!=a.trim(a("#userCommentLink"+b).val())||""!=a.trim(a("#userCommentVideo"+b).val())){a("#commentButton_"+b+" a").addClass("disabled");a("#commentButton_"+b+" a").prepend('<i class="icon-refresh icon-spin"></i>');
var d=0<a("#commentForm_"+b).siblings("input.messageHidden").length?a("#commentForm_"+b).siblings("input.messageHidden").val():a("#commentForm_"+b).val();d={activity_id:b,thumbnail:a("#comment_image_"+b).val(),comment:d,userCommentLink:a("#userCommentLink"+b).val(),userCommentVideo:a("#userCommentVideo"+b).val()};parseInt(c.targetId)==b&&null!=c.params&&a.extend(d,c.params);a.post(mooConfig.url.base+"/activities/ajax_comment",d,function(f){""!=f&&(D(b,f),a(".cmt_preview_link").remove(),a("#userCommentLink"+
b).val(""),a("#userCommentVideo"+b).val(""),f=a("#commentForm_"+b),t.resetMention(f),r.init(),a("body").trigger("afterSubmitCommentCallbackSuccess",[c]))})}else a.fn.SimpleModal({btn_ok:h.__("btn_ok"),btn_cancel:h.__("cancel"),model:"modal",title:h.__("warning"),contents:h.__("share_comment_can_not_empty")}).showModal()}},ca=function(b,c,d){if(q.validateUser()){var f={emptyContent:!1,targetId:"",params:{}};a("body").trigger("beforePostCommentCallback",[f]);if(!0===f.emptyContent&&parseInt(f.targetId)==
d||""!=a.trim(a("#commentForm_"+d).val())||""!=a.trim(a("#comment_image_"+d).val())||""!=a.trim(a("#userCommentLink"+d).val())||""!=a.trim(a("#userCommentVideo"+d).val())){a("#commentButton_"+d+" a").prepend('<i class="icon-refresh icon-spin"></i>');a("#commentButton_"+d+" a").addClass("disabled");var e="";e=0<a("#commentForm_"+d).siblings(".messageHidden").length?a("#commentForm_"+d).siblings(".messageHidden").val():a("#commentForm_"+d).val();b={type:b,target_id:c,thumbnail:a("#comment_image_"+d).val(),
message:e,activity:1,userCommentLink:a("#userCommentLink"+d).val(),userCommentVideo:a("#userCommentVideo"+d).val()};parseInt(f.targetId)==d&&null!=f.params&&a.extend(b,f.params);a.post(mooConfig.url.base+"/comments/ajax_share",b,function(g){""!=g&&(D(d,g),a(".cmt_preview_link").remove(),a("#userCommentLink"+d).val(""),a("#userCommentVideo"+d).val(""),g=a("#commentForm_"+d),t.resetMention(g),r.init(),a("body").trigger("afterSubmitCommentCallbackSuccess",[f]))})}else a.fn.SimpleModal({btn_ok:h.__("btn_ok"),
btn_cancel:h.__("cancel"),model:"modal",title:h.__("warning"),contents:h.__("share_comment_can_not_empty")}).showModal()}},D=function(b,c){var d=a("#comments_"+b).find(".comment_parent_lists");"1"===mooConfig.comment_sort_style?d.append(c):d.prepend(c);a(".slide").slideDown();a("#commentButton_"+b+" a").removeClass("disabled");a("#commentButton_"+b+" a i").remove();a("#commentForm_"+b).val("");a(".commentBox").css("height","27px");a("#comment_preview_image_"+b).html("");a("#comment_image_"+b).val("");
a("#comment_button_attach_"+b).show();p.registerImageComment();y();a("body").trigger("afterActivityShowPostedCommentCallback",[{activity_id:b,data:c}])},da=function(b,c,d){a.post(mooConfig.url.base+"/activities/ajax_changeActivityPrivacy/",{activityId:c,privacy:d},function(f){if(""!=f){f=JSON.parse(f);var e=b.parents(".dropdown");e.find("a#permission_"+c).attr("original-title",f.text);e.find("a#permission_"+c+" .feed_time-icon").removeClass("moo-icon-public moo-icon-people");e.find("a#permission_"+
c+" .feed_time-icon").addClass("moo-icon-"+f.icon).html(f.icon);e.find(".dropdown-menu li a").removeClass("n52");b.addClass("n52")}})},y=function(b){a("textarea:not(.no-grow)").autogrow();T();X();Y();k.initEditActivityComment();k.initRemoveActivityComment();k.initRemoveItemComment();a("body").off("click.activity","a.admin-or-owner-confirm-delete-photo-comment").on("click.activity","a.admin-or-owner-confirm-delete-photo-comment",function(){var c=a(this).data();aa(c.commentId)});a("body").off("click.activity",
"a.viewer-submit-comment").on("click.activity","a.viewer-submit-comment",function(){var c=a(this).data();ba(c.activityId)});a("body").off("click.activity","a.viewer-submit-item-comment").on("click.activity","a.viewer-submit-item-comment",function(){var c=a(this).data();ca(c.itemType,c.activityItemId,c.activityId)});a("body").off("click.activity","a.activity_reply_comment_button").on("click.activity","a.activity_reply_comment_button",function(){var c=a(this).data();type=c.type;id=c.id;E(type,id,0,
c.activity)});a("body").off("click.activity","a.activity_reply_comment").on("click.activity","a.activity_reply_comment",function(){if(q.validateUser()){var c=a(this).data();button=a(this);type=c.type;id=c.id;typeid="";"comment"!=type&&(typeid="activity");var d={emptyContent:!1,targetId:"",params:{}};a("body").trigger("beforePostReplyCallback",[d]);!0===d.emptyContent&&parseInt(d.targetId)==id||""!=a.trim(a("#"+typeid+"commentReplyForm"+id).val())||""!=a.trim(a("#"+typeid+"comment_reply_image_"+id).val())||
""!=a.trim(a("#userReplyLink"+id).val())||""!=a.trim(a("#userReplyVideo"+id).val())?(button.prepend('<i class="icon-refresh icon-spin"></i>'),button.addClass("disabled"),c="",c=0<a("#"+typeid+"commentReplyForm"+id).siblings(".messageHidden").length?a("#"+typeid+"commentReplyForm"+id).siblings(".messageHidden").val():a("#"+typeid+"commentReplyForm"+id).val(),c={activity:1,type:type,target_id:id,thumbnail:a("#"+typeid+"comment_reply_image_"+id).val(),message:c,userCommentLink:a("#userReplyLink"+id).val(),
userCommentVideo:a("#userReplyVideo"+id).val()},parseInt(d.targetId)==id&&null!=d.params&&a.extend(c,d.params),a.post(mooConfig.url.base+"/comments/ajax_share",c,function(f){if(""!=f){var e=a("#"+typeid+"newComment_reply_"+id).parent().find(".comment_reply_lists");a("#"+typeid+"comments_reply_"+id).hasClass("isLoadNew")?e.append(f):"1"===mooConfig.reply_sort_style?e.append(f):e.prepend(f);a(".slide").slideDown("fast",function(){a("body").trigger("afterShowSubmitReplySuccessCallback")});button.removeClass("disabled");
a("#"+typeid+"commentReplyForm"+id).val("");a(".commentBox").css("height","27px");a("#"+typeid+"comment_reply_preview_image_"+id).html("");a("#"+typeid+"comment_reply_image_"+id).val("");a("#"+typeid+"comment_reply_button_attach_"+id).show();p.registerImageComment();f=a("#"+typeid+"commentReplyForm"+id);t.resetMention(f);r.init();a("#userReplyLink"+id).val("");a("#userReplyVideo"+id).val("");a("body").trigger("afterSubmitReplySuccessCallback",[d])}})):a.fn.SimpleModal({btn_ok:h.__("btn_ok"),btn_cancel:h.__("cancel"),
model:"modal",title:h.__("warning"),contents:h.__("share_comment_can_not_empty")}).showModal()}});k.initReplyReply();a("body").off("click.activity","a.activity_reply_comment_viewmore").on("click.activity","a.activity_reply_comment_viewmore",function(){var c=a(this).data();type=c.type;id=c.id;var d=c.close;c=c.activity;"undefined"==typeof d&&(d=0);E(type,id,d,c)});a("body").off("click.activity","a.change-activity-privacy").on("click.activity","a.change-activity-privacy",function(){var c=a(this).data();
da(a(this),c.activityId,c.privacy)});k.initShowCommentForm();O.initLikeActivity();k.initRemoveItemComment();k.initEditItemComment();k.initShowCommentBtn();U();p.initMoreResults();ea();p.initFeedForm();a("body").trigger("afterActivityInitCallback",[])},E=function(b,c,d,f){a(".activity_reply_comment_viewmore").each(function(){data=a(this).data();if(data.id==c&&data.type==b)return a(this).parent().remove(),!0});var e="";if("comment"==b){e="comments_reply_"+c;if(a("#newComment_reply_"+c).is(":visible")&&
!a("#"+e).hasClass("isLoadNew")){a("#newComment_reply_"+c+" .commentBox").focus();return}a("#newComment_reply_"+c).show();a("#newComment_reply_"+c+" .commentBox").focus()}else{e="activitycomments_reply_"+c;if(a("#activitynewComment_reply_"+c).is(":visible")&&!a("#"+e).hasClass("isLoadNew")){a("#activitynewComment_reply_"+c+" .commentBox").focus();return}a("#activitynewComment_reply_"+c).show();a("#activitynewComment_reply_"+c+" .commentBox").focus()}var g=mooConfig.url.base+"/comments/browse/"+b+
"/"+c+"/id_content:"+e;"undefined"!=typeof d&&(g+="/is_close_comment:"+d);"undefined"!=typeof f&&(g+="/activity_id:"+f);a.post(g,function(m){if(""!=m){var n=a("#"+e).find(".comment_reply_lists");a("#"+e).hasClass("isLoadNew")&&(n.empty(),a("#"+e).removeClass("isLoadNew"));"1"===mooConfig.reply_sort_style?n.prepend(m):n.append(m);r.init();p.registerImageComment()}a("body").trigger("afterActivityAjaxShowRepliesCallback",[{type:b,id:c,close_comment:d,activity_id:f}])});a("body").trigger("afterActivityShowRepliesCallback",
[{type:b,id:c,close_comment:d,activity_id:f}])},fa=function(){a("#AddPhotoFeed").removeClass("feed-hide").show();a("#wall_photo_preview").hide();a("#wall_photo").val("");a("#wall_photo_preview").find(".photo-review-thumb").each(function(){"addMoreImage"!=a(this).attr("id")&&a(this).remove()})},ha=function(){a("#AddPhotoFeed").addClass("feed-hide").hide();a("#wall_photo_preview").hide();a("#wall_photo_preview").find(".photo-review-thumb").each(function(){"addMoreImage"!=a(this).attr("id")&&a(this).remove()});
a("#wall_photo").val("")},G=function(){a.when(a("body").on("checkActivityFormActionCallback"),a("body").on("showUploadPhotoFeed"),a("body").on("hideUploadPhotoFeed"),a("body").on("showResetUploadPhotoFeed"),a("body").on("hideResetUploadPhotoFeed")).then(function(b){setTimeout(function(){var c=0;a(".stt-action").find(".stt-action-item").each(function(d,f){a(this).is(":hidden")||a(this).hasClass("feed-hide")?a(this).attr("order",""):(c++,a(this).attr("order",c))});F()},100)})},F=function(){var b=a("#commentButton_0");
0<b.length&&(0<b.position().top?b.parent().addClass("stt-2line"):b.parent().removeClass("stt-2line"))},ia=function(){a(window).resize(function(){F()});G();a("body").on("checkActivityFormActionCallback",function(b,c){G()})},I=function(b){var c=a("#message").val(),d=l(b,"www.tiktok.com",0);!l(b,"https://",0)&&!l(b,"http://",0)||d||(b=(result=b.match(/\b([\d\w\.\/\+\-\?:]*)((ht|f)tp(s|):\/\/|[\d\d\d|\d\d]\.[\d\d\d|\d\d]\.|www\.|\.tv|\.ac|\.com|\.edu|\.gov|\.int|\.mil|\.net|\.org|\.biz|\.info|\.name|\.pro|\.museum|\.co)([\d\w\.\/%\+\-=&amp;\?:\\&quot;',\|~;]*)\b/gi))?
result[0].charAt(0).toLowerCase()+result[0].slice(1):void 0);if(!v.hasOwnProperty(b)&&b&&("http://"==z(b,0,7)||"https://"==z(b,0,8)||"www."==z(b,0,4))){d=l(b,"https://",0);var f=l(b,"http://",0);if(0===d||0===f){d=l(b,"youtube.com",0);f=l(b,"youtu.be",0);var e=l(b,"vimeo.com",0);d||f||e?(a(".userTagging-userShareVideo").removeClass("hidden"),a(".userTagging-userShareLink").addClass("hidden"),a("#userShareLink").val(""),a("#userShareVideo").val(b),H("userShareVideo",b,!0,c)):(a(".userTagging-userShareLink").removeClass("hidden"),
a(".userTagging-userShareVideo").addClass("hidden"),a("#userShareVideo").val(""),H("userShareLink",b,!0,c))}}},z=function(b,c,d){0>c&&(c+=b.length);d=void 0==d?b.length:0>d?d+b.length:d+c;d<c&&(d=c);return b.substring(c,d)},l=function(b,c,d){b=(b+"").indexOf(c,d||0);return-1===b?!1:b},ja=function(){a(".removeImage").unbind("click");a(".removeImage").on("click",function(){a(this).parent().remove();a("#shareImage").val("0")});a(".removeContent").unbind("click");a(".removeContent").on("click",function(){A()})},
A=function(){""!=a.trim(a("#userShareLink").val())&&(v[a.trim(a("#userShareLink").val())]="1");""!=a.trim(a("#userShareVideo").val())&&(v[a.trim(a("#userShareVideo").val())]="1");a("#preview_link").remove();a("#userShareLink").val("");a("#userShareVideo").val("");a("#shareImage").val("1");a("body").trigger("afterDestroyPreviewLinkWallCallback",[])},w=!1,u={},v={},H=function(b,c,d,f){var e=a(".userTagging-"+b);u.hasOwnProperty(c)||e.spin("tiny");setTimeout(function(){w||(u.hasOwnProperty(c)?(console.log(u[c]),
w=!0,J(e,c,d,f,u[c])):(w=!0,a.post(mooConfig.url.base+"/activities/ajax_preview_link",{content:c},function(g){u[c]=g;e.spin(!1);J(e,c,d,f,g)})))},0)},J=function(b,c,d,f,e){a("#preview_link").remove();e=jQuery.parseJSON(e);if(!jQuery.isEmptyObject(e)){var g="";"undefined"!==typeof e.title&&"404 Not Found"!==e.title&&"403 Forbidden"!==e.title?(g='<div class="activity_item activity_item_preview_link" id="preview_link"><a class="removePreviewlink removeContent" href="javascript:void(0)"><i class="icon-delete material-icons">clear</i></a>',
"undefined"!==typeof e.image&&""!=e.image&&(g+='<div class="activity_left"><a class="removePreviewlink removeImage" href="javascript:void(0)"><span class="icon-delete material-icons">clear</span></a>',g=-1!=e.image.indexOf("http")?g+('<img src="'+e.image+'" class="activity-img">'):g+('<img src="'+mooConfig.url.base+"/uploads/links/"+e.image+'" class="activity-img">'),g+='<input type="hidden" name="data[share_image]" id="userShareLink" value="1"></div>'),g=""!=e.image?g+'<div class="activity_right">':
g+"<div>",g+='<a class="activity_item_title attachment_edit_link" href="'+e.url+'" target="_blank" rel="nofollow">',g+=e.title,g+="</a>","undefined"!==typeof e.description&&""!=e.description&&(g=g+'<div class="feed_item_text attachment_body_description"><a class="attachment_edit_link comment_message feed_detail_text">'+(e.description+"</a>"),g+="</div>"),g+='<input type="hidden" name="data[share_text]" id="userShareLink" value="1"></div></div>'):"undefined"!==typeof e.type&&"img"==e.type&&(g='<div class="activity_item activity_item_preview_link" id="preview_link">',
"undefined"!==typeof e.image&&""!=e.image&&(g=g+'<a class="removePreviewlink removeContent" href="javascript:void(0)"><span class="icon-delete material-icons">clear</span></a><div class="activity_parse_img"><img src="'+(e.image+'" class="activity-img">'),g+='<input type="hidden" name="data[share_image]" id="userShareLink" value="1"></div>'),g+='<input type="hidden" name="data[share_text]" id="userShareLink" value="1"></div>');""!=g&&(b.append(g),d&&(a(".textoverlay").text(f),a(".autogrow-textarea-mirror").text(f)),
ja(),a("#userShareLink").val(c),a("body").trigger("afterPreviewLinkWallCallback",[]))}w=!1},ka=function(){if(!q.validateUser())return!1;var b={emptyContent:!1};a("body").trigger("beforePostWall",[b]);var c=a("#message").val();!0===b.emptyContent||""!=a.trim(c)||0<a("#video_destination").length&&""!==a.trim(a("#video_destination").val())||""!=a.trim(a("#userShareLink").val())||""!=a.trim(a("#userShareVideo").val())||""!=a("#wall_photo_preview :not(#addMoreImage)").html()&&"add"!=a("#wall_photo_preview :not(#addMoreImage)").html()?
(B.disableButton("status_btn"),a("#status_btn").spin("small"),a.post(mooConfig.url.base+"/activities/ajax_share",a("#wallForm").serialize(),function(d){a("#wall_photo").val("");B.enableButton("status_btn");a("#message").val("");a(".userTagging-userShareLink").addClass("hidden");a(".userTagging-userShareVideo").addClass("hidden");a("#shareImage").val("1");0<a("#video_destination").length&&""!==a("#video_destination").val()?(a.fn.SimpleModal({model:"content",title:h.__("upload_video_phrase_4"),contents:h.__("upload_video_phrase_0")}).showModal(),
setTimeout(function(){a("#simpleModal").hideModal()},3E3)):""!=d&&(0<a(".no-feed").length&&a("#list-content .no-feed").remove(),0!=a("#chk_story").length&&a("#chk_story").is(":checked")||(a("#list-content").prepend(d),d=a(d).find("div[id^=comment_button_attach_]").data("id"),N.registerAttachComment(d)),a("#message").css("height","36px"),a(".slide").slideDown(),a("#wall_photo_preview .photo-review-thumb:not(.addMoreImage)").remove(),a("#addMoreImage").hide(),a(".form-feed-holder").css("padding-bottom",
"0px"));a("#status_btn").spin(!1);M.init();a(".tip").tipsy({html:!0,gravity:"s"});a('[data-toggle="tooltip"]').tooltip();d=a("#wallForm").find("#message");t.resetMention(d);r.init();a("#preview_link").remove();v={};a("#userShareLink").val("");a("#userShareVideo").val("");a("body").trigger("afterPostWallCallbackSuccess",[])}),a(".stt-action #userTagging-id-userTagging").addClass("hidden"),a(".stt-action").css("margin-top","0"),a("#wall_photo_preview").hide(),a("#userTagging").tagsinput("removeAll")):
a.fn.SimpleModal({btn_ok:h.__("btn_ok"),btn_cancel:h.__("cancel"),model:"modal",title:h.__("warning"),contents:h.__("share_whats_new_can_not_empty")}).showModal()},ea=function(){a(".closeComment").unbind("click");a(".closeComment").click(function(){if(q.validateUser()){a(this).blur();var b=a(this).data();a.post(mooConfig.url.base+"/comments/ajax_close",{item_id:b.id,item_type:b.type},function(c){c=JSON.parse(c);1==c.result&&P.alert(c.message)});"1"==b.close?(a(this).html(h.__("close_comment")),a(this).data("close",
0)):(a(this).html(h.__("open_comment")),a(this).data("close",1))}})};return{init:y,initActivityForm:function(){window.addEventListener("paste",function(b){a("#message").is(":focus")&&Q(b,function(c){var d=new FormData;d.append("qqfile",c);var f=R();a('<span id="feed_'+f+'" class="photo-review-thumb feed_image" style="background-image:url('+mooConfig.url.base+'/img/indicator.gif);background-size:inherit;background-repeat:no-repeat"></span>').insertBefore(".addMoreImage");a("#wall_photo_preview").show();
a("#addMoreImage").show();a.ajax(mooConfig.url.base+"/upload/wall",{method:"POST",data:d,processData:!1,contentType:!1,success:function(e){response=JSON.parse(e);response.success&&(a('[data-toggle="tooltip"]').tooltip("hide"),a('<img src="'+response.file_path+'">').load(function(){var g=a("#feed_"+f);g.data("thumb",response.photo);g.attr("style","background-image:url("+response.file_path+")");var m=a('<a href="javascript:void(0);" class="thumb-review-remove"><i class="material-icons thumb-review-delete">clear</i></a>');
g.append(m);g.find(".thumb-review-delete").unbind("click");g.find(".thumb-review-delete").click(function(n){n.preventDefault();a(this).parents("span").remove();a("#wall_photo").val(a("#wall_photo").val().replace(response.photo+",",""));a("body").trigger("afterDeleteWallPhotoCallback",[response])})}),e=a("#wall_photo").val(),a("#wall_photo").val(e+response.photo+","),A());a("body").trigger("afterUploadWallPhotoCallback",[response])},error:function(){console.log("Upload error")}})})},!1);a('[data-toggle="tooltip"]').tooltip();
0<a("#select-2").length&&new K.fineUploader({element:a("#select-2")[0],text:{uploadButton:'<div class="stt-action-btn"><div class="stt-action-w"><span class="stt-action-icon material-icons">photo_camera</span></div></div>'},validation:{allowedExtensions:mooConfig.photoExt,sizeLimit:mooConfig.sizeLimit},multiple:!0,request:{endpoint:mooConfig.url.base+"/upload/wall"},callbacks:{onError:L.errorHandler,onSubmit:function(b,c){a('<div id="feed_'+b+'" class="photo-review-thumb feed_image" style="background-image:url('+
mooConfig.url.base+'/img/indicator.gif);background-size:inherit;background-repeat:no-repeat"></div>').insertBefore(".addMoreImage");a("#wall_photo_preview").show();a("#addMoreImage").show();a("body").trigger("beforeUploadWallPhotoCallback")},onComplete:function(b,c,d,f){if(d.success){a('[data-toggle="tooltip"]').tooltip("hide");a(this.getItemByFileId(b)).remove();c=a('<img src="'+d.file_path+'">');var e=a("#feed_"+b);e.data("thumb",d.photo);c.load(function(){e=a("#feed_"+b);e.attr("style","background-image:url("+
d.file_path+")");var m=a('<a href="javascript:void(0);" class="thumb-review-remove"><span class="material-icons thumb-review-delete">clear</span></a>');e.append(m);e.find(".thumb-review-delete").unbind("click");e.find(".thumb-review-delete").click(function(n){n.preventDefault();a(this).parent().parent().remove();a("#wall_photo").val(a("#wall_photo").val().replace(d.photo+",",""));a("body").trigger("afterDeleteWallPhotoCallback",[d])})});var g="";a(".feed_image").each(function(){g+=a(this).data("thumb")+
","});a("#wall_photo").val(g);A();a("body").trigger("afterUploadPhotoPlugin3drCallback",[d])}a("body").trigger("afterUploadWallPhotoCallback",[d])}}});a("#addMoreImage").unbind("click");a("#addMoreImage").click(function(){a("#select-2 input[name=file]").click()});a("#message").on("focus",function(){k.showCommentButton(0)});a("#status_btn").unbind("click");a("#status_btn").click(function(){ka()});a("select#privacy").niceSelect();a("#status_box").slideDown("slow",function(){a("body").trigger("afterShowStatusBoxCallback")});
a("#message").on("paste",function(b){if(""==a.trim(a("#wall_photo").val())&&0==a("#preview_link").length&&b.originalEvent.clipboardData){var c=b.originalEvent.clipboardData.getData("text/uri-list");""==c&&(c=b.originalEvent.clipboardData.getData("text/plain"));I(c)}});a("#message").on("keydown keyup keypress",function(b){""!=a.trim(a("#wall_photo").val())||b.ctrlKey||0!=a("#preview_link").length||(b=a(this).val(),I(b))});a("body").on("enablePluginsCallback",function(b,c){-1<c.plugins.indexOf("PhotoFeed")&&
fa()});a("body").on("disablePluginsCallback",function(b,c){-1<c.plugins.indexOf("PhotoFeed")&&ha()});ia()},initOnAjaxLoadActivityEdit:function(){a(".cancelEditActivity").unbind("click");a(".cancelEditActivity").click(function(){var b=a(this).data();C(b.activityId)});a(".confirmEditActivity").unbind("click");a(".confirmEditActivity").click(function(){var b=a(this).data();Z(b.activityId)})}}});