/*
Cropper.js v1.5.6
https://fengyuanchen.github.io/cropperjs

Copyright 2015-present Chen Fengyuan
Released under the MIT license

Date: 2019-10-04T04:33:48.372Z
*/
(function(I,K){"object"===typeof exports&&"undefined"!==typeof module?module.exports=K():"function"===typeof define&&define.amd?define(K):(I=I||self,I.Cropper=K())})(this,function(){function I(a){I="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return I(a)}function K(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=
!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}function va(a,c,b){c&&K(a.prototype,c);b&&K(a,b);return a}function ea(a,c){var b=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);c&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));b.push.apply(b,d)}return b}function fa(a){for(var c=1;c<arguments.length;c++){var b=null!=arguments[c]?arguments[c]:{};c%2?ea(b,!0).forEach(function(c){var d=b[c];c in a?Object.defineProperty(a,
c,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[c]=d}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ea(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))})}return a}function ha(a){if(Array.isArray(a)){var c=0;for(var b=Array(a.length);c<a.length;c++)b[c]=a[c];c=b}else c=void 0;c||(c=Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a)?Array.from(a):void 0);if(!(a=c))throw new TypeError("Invalid attempt to spread non-iterable instance");
return a}function n(a){return"number"===typeof a&&!wa(a)}function X(a){return"undefined"===typeof a}function J(a){return"object"===I(a)&&null!==a}function L(a){if(!J(a))return!1;try{var c=a.constructor,b=c.prototype;return c&&b&&xa.call(b,"isPrototypeOf")}catch(d){return!1}}function z(a){return"function"===typeof a}function ia(a){return Array.from?Array.from(a):ya.call(a)}function t(a,c){a&&z(c)&&(Array.isArray(a)||n(a.length)?ia(a).forEach(function(b,d){c.call(a,b,d,a)}):J(a)&&Object.keys(a).forEach(function(b){c.call(a,
a[b],b,a)}));return a}function M(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1E11;return za.test(a)?Math.round(a*c)/c:a}function G(a,c){var b=a.style;t(c,function(a,c){Aa.test(c)&&n(a)&&(a="".concat(a,"px"));b[c]=a})}function Ba(a,c){return a.classList?a.classList.contains(c):-1<a.className.indexOf(c)}function v(a,c){if(c)if(n(a.length))t(a,function(a){v(a,c)});else if(a.classList)a.classList.add(c);else{var b=a.className.trim();b?0>b.indexOf(c)&&(a.className="".concat(b," ").concat(c)):
a.className=c}}function D(a,c){c&&(n(a.length)?t(a,function(a){D(a,c)}):a.classList?a.classList.remove(c):0<=a.className.indexOf(c)&&(a.className=a.className.replace(c,"")))}function N(a,c,b){c&&(n(a.length)?t(a,function(a){N(a,c,b)}):b?v(a,c):D(a,c))}function Y(a){return a.replace(Ca,"$1-$2").toLowerCase()}function Z(a,c){return J(a[c])?a[c]:a.dataset?a.dataset[c]:a.getAttribute("data-".concat(Y(c)))}function Q(a,c,b){J(b)?a[c]=b:a.dataset?a.dataset[c]=b:a.setAttribute("data-".concat(Y(c)),b)}function C(a,
c,b){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},f=b;c.trim().split(ja).forEach(function(c){if(!ka){var e=a.listeners;e&&e[c]&&e[c][b]&&(f=e[c][b],delete e[c][b],0===Object.keys(e[c]).length&&delete e[c],0===Object.keys(e).length&&delete a.listeners)}a.removeEventListener(c,f,d)})}function B(a,c,b){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},f=b;c.trim().split(ja).forEach(function(c){if(d.once&&!ka){var e=a.listeners,h=void 0===e?{}:e;f=function(){delete h[c][b];
a.removeEventListener(c,f,d);for(var e=arguments.length,g=Array(e),k=0;k<e;k++)g[k]=arguments[k];b.apply(a,g)};h[c]||(h[c]={});h[c][b]&&a.removeEventListener(c,h[c][b],d);h[c][b]=f;a.listeners=h}a.addEventListener(c,f,d)})}function O(a,c,b){if(z(Event)&&z(CustomEvent))var d=new CustomEvent(c,{detail:b,bubbles:!0,cancelable:!0});else d=document.createEvent("CustomEvent"),d.initCustomEvent(c,!0,!0,b);return a.dispatchEvent(d)}function la(a){a=a.getBoundingClientRect();return{left:a.left+(window.pageXOffset-
document.documentElement.clientLeft),top:a.top+(window.pageYOffset-document.documentElement.clientTop)}}function ma(a){a=a.match(Da);return null!==a&&(a[1]!==aa.protocol||a[2]!==aa.hostname||a[3]!==aa.port)}function na(a){var c="timestamp=".concat((new Date).getTime());return a+(-1===a.indexOf("?")?"?":"&")+c}function R(a){var c=a.rotate,b=a.scaleX,d=a.scaleY,f=a.translateX;a=a.translateY;var e=[];n(f)&&0!==f&&e.push("translateX(".concat(f,"px)"));n(a)&&0!==a&&e.push("translateY(".concat(a,"px)"));
n(c)&&0!==c&&e.push("rotate(".concat(c,"deg)"));n(b)&&1!==b&&e.push("scaleX(".concat(b,")"));n(d)&&1!==d&&e.push("scaleY(".concat(d,")"));c=e.length?e.join(" "):"none";return{WebkitTransform:c,msTransform:c,transform:c}}function Ea(a){var c=fa({},a),b=[];t(a,function(a,f){delete c[f];t(c,function(c){var d=Math.abs(a.startX-c.startX),e=Math.abs(a.startY-c.startY),f=Math.abs(a.endX-c.endX);c=Math.abs(a.endY-c.endY);d=Math.sqrt(d*d+e*e);b.push((Math.sqrt(f*f+c*c)-d)/d)})});b.sort(function(a,c){return Math.abs(a)<
Math.abs(c)});return b[0]}function T(a,c){var b=a.pageX,d=a.pageY,f={endX:b,endY:d};return c?f:fa({startX:b,startY:d},f)}function Fa(a){var c=0,b=0,d=0;t(a,function(a){var e=a.startY;c+=a.startX;b+=e;d+=1});c/=d;b/=d;return{pageX:c,pageY:b}}function H(a){var c=a.aspectRatio,b=a.height,d=a.width,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"contain",e=0<d&&Infinity>d,k=0<b&&Infinity>b;e&&k?(e=b*c,"contain"===f&&e>d||"cover"===f&&e<d?b=d/c:d=b*c):e?b=d/c:k&&(d=b*c);return{width:d,height:b}}
function Ga(a,c,b,d){var f=c.aspectRatio,e=c.naturalWidth,k=c.naturalHeight,h=c.rotate;h=void 0===h?0:h;var l=c.scaleX;l=void 0===l?1:l;c=c.scaleY;c=void 0===c?1:c;var g=b.aspectRatio,m=b.naturalWidth,n=b.naturalHeight;b=d.fillColor;b=void 0===b?"transparent":b;var U=d.imageSmoothingEnabled;U=void 0===U?!0:U;var x=d.imageSmoothingQuality;x=void 0===x?"low":x;var p=d.maxWidth,q=void 0===p?Infinity:p;p=d.maxHeight;var w=void 0===p?Infinity:p;p=d.minWidth;var t=void 0===p?0:p;d=d.minHeight;var u=void 0===
d?0:d;d=document.createElement("canvas");p=d.getContext("2d");var r=H({aspectRatio:g,width:q,height:w});g=H({aspectRatio:g,width:t,height:u},"cover");m=Math.min(r.width,Math.max(g.width,m));n=Math.min(r.height,Math.max(g.height,n));g=H({aspectRatio:f,width:q,height:w});f=H({aspectRatio:f,width:t,height:u},"cover");e=Math.min(g.width,Math.max(f.width,e));k=Math.min(g.height,Math.max(f.height,k));k=[-e/2,-k/2,e,k];d.width=M(m);d.height=M(n);p.fillStyle=b;p.fillRect(0,0,m,n);p.save();p.translate(m/2,
n/2);p.rotate(h*Math.PI/180);p.scale(l,c);p.imageSmoothingEnabled=U;p.imageSmoothingQuality=x;p.drawImage.apply(p,[a].concat(ha(k.map(function(a){return Math.floor(M(a))}))));p.restore();return d}function Ha(a){a=a.replace(Ia,"");var c=atob(a);a=new ArrayBuffer(c.length);var b=new Uint8Array(a);t(b,function(a,f){b[f]=c.charCodeAt(f)});return a}var V="undefined"!==typeof window&&"undefined"!==typeof window.document,E=V?window:{},P=V?"ontouchstart"in E.document.documentElement:!1,ba=V?"PointerEvent"in
E:!1,ca="".concat("cropper","-crop"),oa="".concat("cropper","-disabled"),A="".concat("cropper","-hidden"),pa="".concat("cropper","-hide"),Ja="".concat("cropper","-invisible"),W="".concat("cropper","-modal"),da="".concat("cropper","-move"),S="".concat("cropper","Action"),F="".concat("cropper","Preview"),qa=ba?"pointerdown":P?"touchstart":"mousedown",ra=ba?"pointermove":P?"touchmove":"mousemove",sa=ba?"pointerup pointercancel":P?"touchend touchcancel":"mouseup",Ka=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,
La=/^data:/,Ma=/^data:image\/jpeg;base64,/,Na=/^img|canvas$/i,ta={viewMode:0,dragMode:"crop",initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,
minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},wa=Number.isNaN||E.isNaN,xa=Object.prototype.hasOwnProperty,ya=Array.prototype.slice,q=Object.assign||function(a){for(var c=arguments.length,b=Array(1<c?c-1:0),d=1;d<c;d++)b[d-1]=arguments[d];J(a)&&0<b.length&&b.forEach(function(c){J(c)&&Object.keys(c).forEach(function(b){a[b]=c[b]})});return a},za=/\.\d*(?:0|9){12}\d*$/,Aa=/^width|height|left|top|marginLeft|marginTop$/,
Ca=/([a-z\d])([A-Z])/g,ja=/\s\s*/,ka=function(){var a=!1;if(V){var c=!1,b=function(){},d=Object.defineProperty({},"once",{get:function(){a=!0;return c},set:function(a){c=a}});E.addEventListener("test",b,d);E.removeEventListener("test",b,d)}return a}(),aa=E.location,Da=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i,ua=String.fromCharCode,Ia=/^data:.*,/,Oa=E.Cropper;P=function(){function a(c){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
if(!c||!Na.test(c.tagName))throw Error("The first argument is required and must be an <img> or <canvas> element.");this.element=c;this.options=q({},ta,L(b)&&b);this.disabled=this.cropped=!1;this.pointers={};this.sizing=this.sized=this.replaced=this.reloading=this.ready=!1;this.init()}va(a,[{key:"init",value:function(){var a=this.element,b=a.tagName.toLowerCase(),d;if(!a.cropper){a.cropper=this;if("img"===b){this.isImg=!0;this.originalUrl=d=a.getAttribute("src")||"";if(!d)return;d=a.src}else"canvas"===
b&&window.HTMLCanvasElement&&(d=a.toDataURL());this.load(d)}}},{key:"load",value:function(a){var b=this;if(a){this.url=a;this.imageData={};var c=this.element,f=this.options;f.rotatable||f.scalable||(f.checkOrientation=!1);if(f.checkOrientation&&window.ArrayBuffer)if(La.test(a))Ma.test(a)?this.read(Ha(a)):this.clone();else{var e=new XMLHttpRequest,k=this.clone.bind(this);this.reloading=!0;this.xhr=e;e.onabort=k;e.onerror=k;e.ontimeout=k;e.onprogress=function(){"image/jpeg"!==e.getResponseHeader("content-type")&&
e.abort()};e.onload=function(){b.read(e.response)};e.onloadend=function(){b.reloading=!1;b.xhr=null};f.checkCrossOrigin&&ma(a)&&c.crossOrigin&&(a=na(a));e.open("GET",a);e.responseType="arraybuffer";e.withCredentials="use-credentials"===c.crossOrigin;e.send()}else this.clone()}}},{key:"read",value:function(a){var b=this.options,c=this.imageData;var f=new DataView(a);try{var e,k;if(255===f.getUint8(0)&&216===f.getUint8(1))for(var h=f.byteLength,l=2;l+1<h;){if(255===f.getUint8(l)&&225===f.getUint8(l+
1)){var g=l;break}l+=1}if(g){h=g+10;var m=g+4;g=4;l="";for(g+=m;m<g;m+=1)l+=ua(f.getUint8(m));if("Exif"===l){var n=f.getUint16(h);if(((e=18761===n)||19789===n)&&42===f.getUint16(h+2,e)){var q=f.getUint32(h+4,e);8<=q&&(k=h+q)}}}if(k){var x=f.getUint16(k,e),p;for(p=0;p<x;p+=1){var t=k+12*p+2;if(274===f.getUint16(t,e)){t+=8;var w=f.getUint16(t,e);f.setUint16(t,1,e);break}}}}catch(y){w=1}f=w;w=0;k=e=1;if(1<f){w=[];for(a=new Uint8Array(a);0<a.length;)w.push(ua.apply(null,ia(a.subarray(0,8192)))),a=a.subarray(8192);
this.url="data:".concat("image/jpeg",";base64,").concat(btoa(w.join("")));w=0;a=e=1;switch(f){case 2:e=-1;break;case 3:w=-180;break;case 4:a=-1;break;case 5:w=90;a=-1;break;case 6:w=90;break;case 7:w=90;e=-1;break;case 8:w=-90}k=a}b.rotatable&&(c.rotate=w);b.scalable&&(c.scaleX=e,c.scaleY=k);this.clone()}},{key:"clone",value:function(){var a=this.element,b=this.url,d=a.crossOrigin,f=b;this.options.checkCrossOrigin&&ma(b)&&(d||(d="anonymous"),f=na(b));this.crossOrigin=d;this.crossOriginUrl=f;var e=
document.createElement("img");d&&(e.crossOrigin=d);e.src=f||b;e.alt=a.alt||"The image to crop";this.image=e;e.onload=this.start.bind(this);e.onerror=this.stop.bind(this);v(e,pa);a.parentNode.insertBefore(e,a.nextSibling)}},{key:"start",value:function(){var a=this,b=this.image;b.onload=null;b.onerror=null;this.sizing=!0;var d=E.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(E.navigator.userAgent),f=function(b,c){q(a.imageData,{naturalWidth:b,naturalHeight:c,aspectRatio:b/c});a.sizing=!1;a.sized=
!0;a.build()};if(b.naturalWidth&&!d)f(b.naturalWidth,b.naturalHeight);else{var e=document.createElement("img"),k=document.body||document.documentElement;this.sizingImage=e;e.onload=function(){f(e.width,e.height);d||k.removeChild(e)};e.src=b.src;d||(e.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",k.appendChild(e))}}},{key:"stop",value:function(){var a=this.image;a.onload=null;a.onerror=
null;a.parentNode.removeChild(a);this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var a=this.element,b=this.options,d=this.image,f=a.parentNode,e=document.createElement("div");e.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';
e=e.querySelector(".".concat("cropper","-container"));var k=e.querySelector(".".concat("cropper","-canvas")),h=e.querySelector(".".concat("cropper","-drag-box")),l=e.querySelector(".".concat("cropper","-crop-box")),g=l.querySelector(".".concat("cropper","-face"));this.container=f;this.cropper=e;this.canvas=k;this.dragBox=h;this.cropBox=l;this.viewBox=e.querySelector(".".concat("cropper","-view-box"));this.face=g;k.appendChild(d);v(a,A);f.insertBefore(e,a.nextSibling);this.isImg||D(d,pa);this.initPreview();
this.bind();b.initialAspectRatio=Math.max(0,b.initialAspectRatio)||NaN;b.aspectRatio=Math.max(0,b.aspectRatio)||NaN;b.viewMode=Math.max(0,Math.min(3,Math.round(b.viewMode)))||0;v(l,A);b.guides||v(l.getElementsByClassName("".concat("cropper","-dashed")),A);b.center||v(l.getElementsByClassName("".concat("cropper","-center")),A);b.background&&v(e,"".concat("cropper","-bg"));b.highlight||v(g,Ja);b.cropBoxMovable&&(v(g,da),Q(g,S,"all"));b.cropBoxResizable||(v(l.getElementsByClassName("".concat("cropper",
"-line")),A),v(l.getElementsByClassName("".concat("cropper","-point")),A));this.render();this.ready=!0;this.setDragMode(b.dragMode);b.autoCrop&&this.crop();this.setData(b.data);z(b.ready)&&B(a,"ready",b.ready,{once:!0});O(a,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),D(this.element,A))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.cropped=this.ready=!1):this.sizing?(this.sizingImage.onload=
null,this.sized=this.sizing=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){window.Cropper=Oa;return a}},{key:"setDefaults",value:function(a){q(ta,L(a)&&a)}}]);return a}();q(P.prototype,{render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.element,c=this.options,b=this.container,d=this.cropper;v(d,A);D(a,A);this.containerData=
c={width:Math.max(b.offsetWidth,Number(c.minContainerWidth)||200),height:Math.max(b.offsetHeight,Number(c.minContainerHeight)||100)};G(d,{width:c.width,height:c.height});v(a,A);D(d,A)},initCanvas:function(){var a=this.containerData,c=this.imageData,b=this.options.viewMode,d=90===Math.abs(c.rotate)%180,f=d?c.naturalHeight:c.naturalWidth,e=d?c.naturalWidth:c.naturalHeight,k=f/e;d=a.width;var h=a.height;a.height*k>a.width?3===b?d=a.height*k:h=a.width/k:3===b?h=a.width/k:d=a.height*k;f={aspectRatio:k,
naturalWidth:f,naturalHeight:e,width:d,height:h};f.left=(a.width-d)/2;f.top=(a.height-h)/2;f.oldLeft=f.left;f.oldTop=f.top;this.canvasData=f;this.limited=1===b||2===b;this.limitCanvas(!0,!0);this.initialImageData=q({},c);this.initialCanvasData=q({},f)},limitCanvas:function(a,c){var b=this.options,d=this.containerData,f=this.canvasData,e=this.cropBoxData,k=b.viewMode,h=f.aspectRatio,l=this.cropped&&e;if(a){var g=Number(b.minCanvasWidth)||0;b=Number(b.minCanvasHeight)||0;1<k?(g=Math.max(g,d.width),
b=Math.max(b,d.height),3===k&&(b*h>g?g=b*h:b=g/h)):0<k&&(g?g=Math.max(g,l?e.width:0):b?b=Math.max(b,l?e.height:0):l&&(g=e.width,b=e.height,b*h>g?g=b*h:b=g/h));h=H({aspectRatio:h,width:g,height:b});g=h.width;b=h.height;f.minWidth=g;f.minHeight=b;f.maxWidth=Infinity;f.maxHeight=Infinity}c&&(k>(l?0:1)?(g=d.width-f.width,h=d.height-f.height,f.minLeft=Math.min(0,g),f.minTop=Math.min(0,h),f.maxLeft=Math.max(0,g),f.maxTop=Math.max(0,h),l&&this.limited&&(f.minLeft=Math.min(e.left,e.left+(e.width-f.width)),
f.minTop=Math.min(e.top,e.top+(e.height-f.height)),f.maxLeft=e.left,f.maxTop=e.top,2===k&&(f.width>=d.width&&(f.minLeft=Math.min(0,g),f.maxLeft=Math.max(0,g)),f.height>=d.height&&(f.minTop=Math.min(0,h),f.maxTop=Math.max(0,h))))):(f.minLeft=-f.width,f.minTop=-f.height,f.maxLeft=d.width,f.maxTop=d.height))},renderCanvas:function(a,c){var b=this.canvasData,d=this.imageData;if(c){var f=d.naturalWidth*Math.abs(d.scaleX||1);var e=d.naturalHeight*Math.abs(d.scaleY||1);d=d.rotate||0;d=Math.abs(d)%180;if(90===
d)e={width:e,height:f};else{var k=d%90*Math.PI/180,h=Math.sin(k),l=Math.cos(k);k=f*l+e*h;f=f*h+e*l;e=90<d?{width:f,height:k}:{width:k,height:f}}f=e.width;e=e.height;d=f/b.naturalWidth*b.width;h=e/b.naturalHeight*b.height;b.left-=(d-b.width)/2;b.top-=(h-b.height)/2;b.width=d;b.height=h;b.aspectRatio=f/e;b.naturalWidth=f;b.naturalHeight=e;this.limitCanvas(!0,!1)}if(b.width>b.maxWidth||b.width<b.minWidth)b.left=b.oldLeft;if(b.height>b.maxHeight||b.height<b.minHeight)b.top=b.oldTop;b.width=Math.min(Math.max(b.width,
b.minWidth),b.maxWidth);b.height=Math.min(Math.max(b.height,b.minHeight),b.maxHeight);this.limitCanvas(!1,!0);b.left=Math.min(Math.max(b.left,b.minLeft),b.maxLeft);b.top=Math.min(Math.max(b.top,b.minTop),b.maxTop);b.oldLeft=b.left;b.oldTop=b.top;G(this.canvas,q({width:b.width,height:b.height},R({translateX:b.left,translateY:b.top})));this.renderImage(a);this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(a){var c=this.canvasData,b=this.imageData,d=c.width/c.naturalWidth*b.naturalWidth,
f=c.height/c.naturalHeight*b.naturalHeight;q(b,{width:d,height:f,left:(c.width-d)/2,top:(c.height-f)/2});G(this.image,q({width:b.width,height:b.height},R(q({translateX:b.left,translateY:b.top},b))));a&&this.output()},initCropBox:function(){var a=this.options,c=this.canvasData,b=a.aspectRatio||a.initialAspectRatio;a=Number(a.autoCropArea)||.8;var d={width:c.width,height:c.height};b&&(c.height*b>c.width?d.height=d.width/b:d.width=d.height*b);this.cropBoxData=d;this.limitCropBox(!0,!0);d.width=Math.min(Math.max(d.width,
d.minWidth),d.maxWidth);d.height=Math.min(Math.max(d.height,d.minHeight),d.maxHeight);d.width=Math.max(d.minWidth,d.width*a);d.height=Math.max(d.minHeight,d.height*a);d.left=c.left+(c.width-d.width)/2;d.top=c.top+(c.height-d.height)/2;d.oldLeft=d.left;d.oldTop=d.top;this.initialCropBoxData=q({},d)},limitCropBox:function(a,c){var b=this.options,d=this.containerData,f=this.canvasData,e=this.cropBoxData,k=this.limited,h=b.aspectRatio;if(a){var l=Number(b.minCropBoxWidth)||0;b=Number(b.minCropBoxHeight)||
0;var g=k?Math.min(d.width,f.width,f.width+f.left,d.width-f.left):d.width,m=k?Math.min(d.height,f.height,f.height+f.top,d.height-f.top):d.height;l=Math.min(l,d.width);b=Math.min(b,d.height);h&&(l&&b?b*h>l?b=l/h:l=b*h:l?b=l/h:b&&(l=b*h),m*h>g?m=g/h:g=m*h);e.minWidth=Math.min(l,g);e.minHeight=Math.min(b,m);e.maxWidth=g;e.maxHeight=m}c&&(k?(e.minLeft=Math.max(0,f.left),e.minTop=Math.max(0,f.top),e.maxLeft=Math.min(d.width,f.left+f.width)-e.width,e.maxTop=Math.min(d.height,f.top+f.height)-e.height):(e.minLeft=
0,e.minTop=0,e.maxLeft=d.width-e.width,e.maxTop=d.height-e.height))},renderCropBox:function(){var a=this.options,c=this.containerData,b=this.cropBoxData;if(b.width>b.maxWidth||b.width<b.minWidth)b.left=b.oldLeft;if(b.height>b.maxHeight||b.height<b.minHeight)b.top=b.oldTop;b.width=Math.min(Math.max(b.width,b.minWidth),b.maxWidth);b.height=Math.min(Math.max(b.height,b.minHeight),b.maxHeight);this.limitCropBox(!1,!0);b.left=Math.min(Math.max(b.left,b.minLeft),b.maxLeft);b.top=Math.min(Math.max(b.top,
b.minTop),b.maxTop);b.oldLeft=b.left;b.oldTop=b.top;a.movable&&a.cropBoxMovable&&Q(this.face,S,b.width>=c.width&&b.height>=c.height?"move":"all");G(this.cropBox,q({width:b.width,height:b.height},R({translateX:b.left,translateY:b.top})));this.cropped&&this.limited&&this.limitCanvas(!0,!0);this.disabled||this.output()},output:function(){this.preview();O(this.element,"crop",this.getData())}},{initPreview:function(){var a=this.element,c=this.crossOrigin,b=this.options.preview,d=c?this.crossOriginUrl:
this.url,f=a.alt||"The image to preview",e=document.createElement("img");c&&(e.crossOrigin=c);-1!==d.indexOf("?")&&(d+="1");e.src=d;e.alt=f;this.viewBox.appendChild(e);this.viewBoxImage=e;b&&(e=b,"string"===typeof b?e=a.ownerDocument.querySelectorAll(b):b.querySelector&&(e=[b]),this.previews=e,t(e,function(a){var b=document.createElement("img");Q(a,F,{width:a.offsetWidth,height:a.offsetHeight,html:a.innerHTML});c&&(b.crossOrigin=c);b.src=d;b.alt=f;b.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';
a.innerHTML="";a.appendChild(b)}))},resetPreview:function(){t(this.previews,function(a){var c=Z(a,F);G(a,{width:c.width,height:c.height});a.innerHTML=c.html;if(J(a[F]))try{delete a[F]}catch(b){a[F]=void 0}else if(a.dataset)try{delete a.dataset[F]}catch(b){a.dataset[F]=void 0}else a.removeAttribute("data-".concat(Y(F)))})},preview:function(){var a=this.imageData,c=this.canvasData,b=this.cropBoxData,d=b.width,f=b.height,e=a.width,k=a.height,h=b.left-c.left-a.left,l=b.top-c.top-a.top;this.cropped&&!this.disabled&&
(G(this.viewBoxImage,q({width:e,height:k},R(q({translateX:-h,translateY:-l},a)))),t(this.previews,function(b){var c=Z(b,F),g=c.width;c=c.height;var n=g,t=c,p=1;d&&(p=g/d,t=f*p);f&&t>c&&(p=c/f,n=d*p,t=c);G(b,{width:n,height:t});G(b.getElementsByTagName("img")[0],q({width:e*p,height:k*p},R(q({translateX:-h*p,translateY:-l*p},a))))}))}},{bind:function(){var a=this.element,c=this.options,b=this.cropper;z(c.cropstart)&&B(a,"cropstart",c.cropstart);z(c.cropmove)&&B(a,"cropmove",c.cropmove);z(c.cropend)&&
B(a,"cropend",c.cropend);z(c.crop)&&B(a,"crop",c.crop);z(c.zoom)&&B(a,"zoom",c.zoom);B(b,qa,this.onCropStart=this.cropStart.bind(this));c.zoomable&&c.zoomOnWheel&&B(b,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0});c.toggleDragModeOnDblclick&&B(b,"dblclick",this.onDblclick=this.dblclick.bind(this));B(a.ownerDocument,ra,this.onCropMove=this.cropMove.bind(this));B(a.ownerDocument,sa,this.onCropEnd=this.cropEnd.bind(this));c.responsive&&B(window,"resize",this.onResize=this.resize.bind(this))},
unbind:function(){var a=this.element,c=this.options,b=this.cropper;z(c.cropstart)&&C(a,"cropstart",c.cropstart);z(c.cropmove)&&C(a,"cropmove",c.cropmove);z(c.cropend)&&C(a,"cropend",c.cropend);z(c.crop)&&C(a,"crop",c.crop);z(c.zoom)&&C(a,"zoom",c.zoom);C(b,qa,this.onCropStart);c.zoomable&&c.zoomOnWheel&&C(b,"wheel",this.onWheel,{passive:!1,capture:!0});c.toggleDragModeOnDblclick&&C(b,"dblclick",this.onDblclick);C(a.ownerDocument,ra,this.onCropMove);C(a.ownerDocument,sa,this.onCropEnd);c.responsive&&
C(window,"resize",this.onResize)}},{resize:function(){var a=this.options,c=this.container,b=this.containerData,d=Number(a.minContainerWidth)||200,f=Number(a.minContainerHeight)||100;if(!(this.disabled||b.width<=d||b.height<=f)){var e=c.offsetWidth/b.width;if(1!==e||c.offsetHeight!==b.height){if(a.restore){var k=this.getCanvasData();var h=this.getCropBoxData()}this.render();a.restore&&(this.setCanvasData(t(k,function(a,b){k[b]=a*e})),this.setCropBoxData(t(h,function(a,b){h[b]=a*e})))}}},dblclick:function(){this.disabled||
"none"===this.options.dragMode||this.setDragMode(Ba(this.dragBox,ca)?"move":"crop")},wheel:function(a){var c=this,b=Number(this.options.wheelZoomRatio)||.1,d=1;this.disabled||(a.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){c.wheeling=!1},50),a.deltaY?d=0<a.deltaY?1:-1:a.wheelDelta?d=-a.wheelDelta/120:a.detail&&(d=0<a.detail?1:-1),this.zoom(-d*b,a)))},cropStart:function(a){var c=a.buttons,b=a.button;if(!(this.disabled||("mousedown"===a.type||"pointerdown"===a.type&&"mouse"===
a.pointerType)&&(n(c)&&1!==c||n(b)&&0!==b||a.ctrlKey))){c=this.options;var d=this.pointers;a.changedTouches?t(a.changedTouches,function(a){d[a.identifier]=T(a)}):d[a.pointerId||0]=T(a);c=1<Object.keys(d).length&&c.zoomable&&c.zoomOnTouch?"zoom":Z(a.target,S);Ka.test(c)&&!1!==O(this.element,"cropstart",{originalEvent:a,action:c})&&(a.preventDefault(),this.action=c,this.cropping=!1,"crop"===c&&(this.cropping=!0,v(this.dragBox,W)))}},cropMove:function(a){var c=this.action;if(!this.disabled&&c){var b=
this.pointers;a.preventDefault();!1!==O(this.element,"cropmove",{originalEvent:a,action:c})&&(a.changedTouches?t(a.changedTouches,function(a){q(b[a.identifier]||{},T(a,!0))}):q(b[a.pointerId||0]||{},T(a,!0)),this.change(a))}},cropEnd:function(a){if(!this.disabled){var c=this.action,b=this.pointers;a.changedTouches?t(a.changedTouches,function(a){delete b[a.identifier]}):delete b[a.pointerId||0];c&&(a.preventDefault(),Object.keys(b).length||(this.action=""),this.cropping&&(this.cropping=!1,N(this.dragBox,
W,this.cropped&&this.options.modal)),O(this.element,"cropend",{originalEvent:a,action:c}))}}},{change:function(a){var c=this.canvasData,b=this.containerData,d=this.cropBoxData,f=this.pointers,e=this.action,k=this.options.aspectRatio,h=d.left,l=d.top,g=d.width,m=d.height,n=h+g,q=l+m,x=0,p=0,v=b.width,w=b.height,y=!0;!k&&a.shiftKey&&(k=g&&m?g/m:1);this.limited&&(x=d.minLeft,p=d.minTop,v=x+Math.min(b.width,c.width,c.left+c.width),w=p+Math.min(b.height,c.height,c.top+c.height));c=f[Object.keys(f)[0]];
var u=c.endX-c.startX,r=c.endY-c.startY;b=function(a){switch(a){case "e":n+u>v&&(u=v-n);break;case "w":h+u<x&&(u=x-h);break;case "n":l+r<p&&(r=p-l);break;case "s":q+r>w&&(r=w-q)}};switch(e){case "all":h+=u;l+=r;break;case "e":if(0<=u&&(n>=v||k&&(l<=p||q>=w))){y=!1;break}b("e");g+=u;0>g&&(e="w",g=-g,h-=g);k&&(m=g/k,l+=(d.height-m)/2);break;case "n":if(0>=r&&(l<=p||k&&(h<=x||n>=v))){y=!1;break}b("n");m-=r;l+=r;0>m&&(e="s",m=-m,l-=m);k&&(g=m*k,h+=(d.width-g)/2);break;case "w":if(0>=u&&(h<=x||k&&(l<=
p||q>=w))){y=!1;break}b("w");g-=u;h+=u;0>g&&(e="e",g=-g,h-=g);k&&(m=g/k,l+=(d.height-m)/2);break;case "s":if(0<=r&&(q>=w||k&&(h<=x||n>=v))){y=!1;break}b("s");m+=r;0>m&&(e="n",m=-m,l-=m);k&&(g=m*k,h+=(d.width-g)/2);break;case "ne":if(k){if(0>=r&&(l<=p||n>=v)){y=!1;break}b("n");m-=r;l+=r;g=m*k}else b("n"),b("e"),0<=u?n<v?g+=u:0>=r&&l<=p&&(y=!1):g+=u,0>=r?l>p&&(m-=r,l+=r):(m-=r,l+=r);0>g&&0>m?(e="sw",m=-m,g=-g,l-=m,h-=g):0>g?(e="nw",g=-g,h-=g):0>m&&(e="se",m=-m,l-=m);break;case "nw":if(k){if(0>=r&&(l<=
p||h<=x)){y=!1;break}b("n");m-=r;l+=r;g=m*k;h+=d.width-g}else b("n"),b("w"),0>=u?h>x?(g-=u,h+=u):0>=r&&l<=p&&(y=!1):(g-=u,h+=u),0>=r?l>p&&(m-=r,l+=r):(m-=r,l+=r);0>g&&0>m?(e="se",m=-m,g=-g,l-=m,h-=g):0>g?(e="ne",g=-g,h-=g):0>m&&(e="sw",m=-m,l-=m);break;case "sw":if(k){if(0>=u&&(h<=x||q>=w)){y=!1;break}b("w");g-=u;h+=u;m=g/k}else b("s"),b("w"),0>=u?h>x?(g-=u,h+=u):0<=r&&q>=w&&(y=!1):(g-=u,h+=u),0<=r?q<w&&(m+=r):m+=r;0>g&&0>m?(e="ne",m=-m,g=-g,l-=m,h-=g):0>g?(e="se",g=-g,h-=g):0>m&&(e="nw",m=-m,l-=
m);break;case "se":if(k){if(0<=u&&(n>=v||q>=w)){y=!1;break}b("e");g+=u;m=g/k}else b("s"),b("e"),0<=u?n<v?g+=u:0<=r&&q>=w&&(y=!1):g+=u,0<=r?q<w&&(m+=r):m+=r;0>g&&0>m?(e="nw",m=-m,g=-g,l-=m,h-=g):0>g?(e="sw",g=-g,h-=g):0>m&&(e="ne",m=-m,l-=m);break;case "move":this.move(u,r);y=!1;break;case "zoom":this.zoom(Ea(f),a);y=!1;break;case "crop":u&&r?(a=la(this.cropper),h=c.startX-a.left,l=c.startY-a.top,g=d.minWidth,m=d.minHeight,0<u?e=0<r?"se":"ne":0>u&&(h-=g,e=0<r?"sw":"nw"),0>r&&(l-=m),this.cropped||(D(this.cropBox,
A),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))):y=!1}y&&(d.width=g,d.height=m,d.left=h,d.top=l,this.action=e,this.renderCropBox());t(f,function(a){a.startX=a.endX;a.startY=a.endY})}},{crop:function(){!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&v(this.dragBox,W),D(this.cropBox,A),this.setCropBoxData(this.initialCropBoxData));return this},reset:function(){this.ready&&!this.disabled&&(this.imageData=q({},this.initialImageData),this.canvasData=
q({},this.initialCanvasData),this.cropBoxData=q({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox());return this},clear:function(){this.cropped&&!this.disabled&&(q(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),D(this.dragBox,W),v(this.cropBox,A));return this},replace:function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;!this.disabled&&a&&(this.isImg&&(this.element.src=
a),c?(this.url=a,this.image.src=a,this.ready&&(this.viewBoxImage.src=a,t(this.previews,function(b){b.getElementsByTagName("img")[0].src=a}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(a)));return this},enable:function(){this.ready&&this.disabled&&(this.disabled=!1,D(this.cropper,oa));return this},disable:function(){this.ready&&!this.disabled&&(this.disabled=!0,v(this.cropper,oa));return this},destroy:function(){var a=this.element;if(!a.cropper)return this;a.cropper=
void 0;this.isImg&&this.replaced&&(a.src=this.originalUrl);this.uncreate();return this},move:function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a,b=this.canvasData,d=b.left;b=b.top;return this.moveTo(X(a)?a:d+Number(a),X(c)?c:b+Number(c))},moveTo:function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a,b=this.canvasData,d=!1;a=Number(a);c=Number(c);this.ready&&!this.disabled&&this.options.movable&&(n(a)&&(b.left=a,d=!0),n(c)&&(b.top=c,d=!0),d&&this.renderCanvas(!0));
return this},zoom:function(a,c){var b=this.canvasData;a=Number(a);return this.zoomTo(b.width*(0>a?1/(1-a):1+a)/b.naturalWidth,null,c)},zoomTo:function(a,c,b){var d=this.options,f=this.canvasData,e=f.width,k=f.height,h=f.naturalWidth,l=f.naturalHeight;a=Number(a);if(0<=a&&this.ready&&!this.disabled&&d.zoomable){d=h*a;l*=a;if(!1===O(this.element,"zoom",{ratio:a,oldRatio:e/h,originalEvent:b}))return this;b?(c=this.pointers,a=la(this.cropper),b=c&&Object.keys(c).length?Fa(c):{pageX:b.pageX,pageY:b.pageY},
f.left-=(b.pageX-a.left-f.left)/e*(d-e),f.top-=(b.pageY-a.top-f.top)/k*(l-k)):L(c)&&n(c.x)&&n(c.y)?(f.left-=(c.x-f.left)/e*(d-e),f.top-=(c.y-f.top)/k*(l-k)):(f.left-=(d-e)/2,f.top-=(l-k)/2);f.width=d;f.height=l;this.renderCanvas(!0)}return this},rotate:function(a){return this.rotateTo((this.imageData.rotate||0)+Number(a))},rotateTo:function(a){a=Number(a);n(a)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=a%360,this.renderCanvas(!0,!0));return this},scaleX:function(a){var c=
this.imageData.scaleY;return this.scale(a,n(c)?c:1)},scaleY:function(a){var c=this.imageData.scaleX;return this.scale(n(c)?c:1,a)},scale:function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a,b=this.imageData,d=!1;a=Number(a);c=Number(c);this.ready&&!this.disabled&&this.options.scalable&&(n(a)&&(b.scaleX=a,d=!0),n(c)&&(b.scaleY=c,d=!0),d&&this.renderCanvas(!0,!0));return this},getData:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!1,c=this.options,b=this.imageData,
d=this.canvasData,f=this.cropBoxData;if(this.ready&&this.cropped){var e={x:f.left-d.left,y:f.top-d.top,width:f.width,height:f.height};var k=b.width/b.naturalWidth;t(e,function(a,b){e[b]=a/k});a&&(a=Math.round(e.y+e.height),d=Math.round(e.x+e.width),e.x=Math.round(e.x),e.y=Math.round(e.y),e.width=d-e.x,e.height=a-e.y)}else e={x:0,y:0,width:0,height:0};c.rotatable&&(e.rotate=b.rotate||0);c.scalable&&(e.scaleX=b.scaleX||1,e.scaleY=b.scaleY||1);return e},setData:function(a){var c=this.options,b=this.imageData,
d=this.canvasData,f={};if(this.ready&&!this.disabled&&L(a)){var e=!1;c.rotatable&&n(a.rotate)&&a.rotate!==b.rotate&&(b.rotate=a.rotate,e=!0);c.scalable&&(n(a.scaleX)&&a.scaleX!==b.scaleX&&(b.scaleX=a.scaleX,e=!0),n(a.scaleY)&&a.scaleY!==b.scaleY&&(b.scaleY=a.scaleY,e=!0));e&&this.renderCanvas(!0,!0);c=b.width/b.naturalWidth;n(a.x)&&(f.left=a.x*c+d.left);n(a.y)&&(f.top=a.y*c+d.top);n(a.width)&&(f.width=a.width*c);n(a.height)&&(f.height=a.height*c);this.setCropBoxData(f)}return this},getContainerData:function(){return this.ready?
q({},this.containerData):{}},getImageData:function(){return this.sized?q({},this.imageData):{}},getCanvasData:function(){var a=this.canvasData,c={};this.ready&&t("left top width height naturalWidth naturalHeight".split(" "),function(b){c[b]=a[b]});return c},setCanvasData:function(a){var c=this.canvasData,b=c.aspectRatio;this.ready&&!this.disabled&&L(a)&&(n(a.left)&&(c.left=a.left),n(a.top)&&(c.top=a.top),n(a.width)?(c.width=a.width,c.height=a.width/b):n(a.height)&&(c.height=a.height,c.width=a.height*
b),this.renderCanvas(!0));return this},getCropBoxData:function(){var a=this.cropBoxData,c;this.ready&&this.cropped&&(c={left:a.left,top:a.top,width:a.width,height:a.height});return c||{}},setCropBoxData:function(a){var c=this.cropBoxData,b=this.options.aspectRatio;if(this.ready&&this.cropped&&!this.disabled&&L(a)){n(a.left)&&(c.left=a.left);n(a.top)&&(c.top=a.top);if(n(a.width)&&a.width!==c.width){var d=!0;c.width=a.width}if(n(a.height)&&a.height!==c.height){var f=!0;c.height=a.height}b&&(d?c.height=
c.width/b:f&&(c.width=c.height*b));this.renderCropBox()}return this},getCroppedCanvas:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var c=this.canvasData,b=Ga(this.image,this.imageData,c,a);if(!this.cropped)return b;var d=this.getData(),f=d.x,e=d.y,k=d.width;d=d.height;c=b.width/Math.floor(c.naturalWidth);1!==c&&(f*=c,e*=c,k*=c,d*=c);var h=k/d,l=H({aspectRatio:h,width:a.maxWidth||Infinity,height:a.maxHeight||Infinity}),
g=H({aspectRatio:h,width:a.minWidth||0,height:a.minHeight||0},"cover");h=H({aspectRatio:h,width:a.width||(1!==c?b.width:k),height:a.height||(1!==c?b.height:d)});c=h.width;h=h.height;c=Math.min(l.width,Math.max(g.width,c));h=Math.min(l.height,Math.max(g.height,h));l=document.createElement("canvas");g=l.getContext("2d");l.width=M(c);l.height=M(h);g.fillStyle=a.fillColor||"transparent";g.fillRect(0,0,c,h);h=a.imageSmoothingEnabled;a=a.imageSmoothingQuality;g.imageSmoothingEnabled=void 0===h?!0:h;a&&
(g.imageSmoothingQuality=a);a=b.width;h=b.height;var m,n,q,t;if(f<=-k||f>a)var p=q=m=f=0;else 0>=f?(q=-f,f=0,p=m=Math.min(a,k+f)):f<=a&&(q=0,p=m=Math.min(k,a-f));if(0>=m||e<=-d||e>h)var v=t=n=e=0;else 0>=e?(t=-e,e=0,v=n=Math.min(h,d+e)):e<=h&&(t=0,v=n=Math.min(d,h-e));m=[f,e,m,n];0<p&&0<v&&(k=c/k,m.push(q*k,t*k,p*k,v*k));g.drawImage.apply(g,[b].concat(ha(m.map(function(a){return Math.floor(M(a))}))));return l},setAspectRatio:function(a){var c=this.options;this.disabled||X(a)||(c.aspectRatio=Math.max(0,
a)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox()));return this},setDragMode:function(a){var c=this.options,b=this.dragBox,d=this.face;if(this.ready&&!this.disabled){var f="crop"===a,e=c.movable&&"move"===a;a=f||e?a:"none";c.dragMode=a;Q(b,S,a);N(b,ca,f);N(b,da,e);c.cropBoxMovable||(Q(d,S,a),N(d,ca,f),N(d,da,e))}return this}});return P});